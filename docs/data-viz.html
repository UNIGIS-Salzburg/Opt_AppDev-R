<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Lesson 10 Data Visualization | Automated Data Processing with R</title>
  <meta name="description" content="BookDown materials for the UNIGIS module Application Development - Introduction to R." />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="Lesson 10 Data Visualization | Automated Data Processing with R" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/branding/Cover_epub.png" />
  <meta property="og:description" content="BookDown materials for the UNIGIS module Application Development - Introduction to R." />
  <meta name="github-repo" content="UNIGIS-Salzburg/En_AppDev-R" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Lesson 10 Data Visualization | Automated Data Processing with R" />
  
  <meta name="twitter:description" content="BookDown materials for the UNIGIS module Application Development - Introduction to R." />
  <meta name="twitter:image" content="/branding/Cover_epub.png" />

<meta name="author" content="Christian Neuwirth &amp; Maximilian Elixhauser" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="branding/unigis_globe_gruen_transparent.png" type="image/x-icon" />
<link rel="prev" href="spm.html"/>
<link rel="next" href="r-markdown.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.2.2/leaflet.js"></script>
<script src="libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.2.2/leaflet-providers-plugin.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="css/custom.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://unigis.at/en" target="_blank"><img alt="UNIGIS Salzburg" src="branding/UNIGIS_Salzburg_Schriftlogo_v05.png" width=100%></a></li>
<li><a href="./">Automated Data Processing with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction to R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#about-this-module"><i class="fa fa-check"></i><b>1.1</b> About this module</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#r-programming-language"><i class="fa fa-check"></i><b>1.2</b> R programming language</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#installation-and-setup"><i class="fa fa-check"></i><b>1.3</b> Installation and Setup</a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#interpreting-values"><i class="fa fa-check"></i><b>1.4</b> Interpreting Values</a></li>
<li class="chapter" data-level="1.5" data-path="intro.html"><a href="intro.html#simple-data-types"><i class="fa fa-check"></i><b>1.5</b> Simple Data Types</a></li>
<li class="chapter" data-level="1.6" data-path="intro.html"><a href="intro.html#numop"><i class="fa fa-check"></i><b>1.6</b> Numeric operators</a></li>
<li class="chapter" data-level="1.7" data-path="intro.html"><a href="intro.html#logical-operators"><i class="fa fa-check"></i><b>1.7</b> Logical operators</a></li>
<li class="chapter" data-level="1.8" data-path="intro.html"><a href="intro.html#references"><i class="fa fa-check"></i><b>1.8</b> References</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="core.html"><a href="core.html"><i class="fa fa-check"></i><b>2</b> Core Concepts</a>
<ul>
<li class="chapter" data-level="2.1" data-path="core.html"><a href="core.html#variables"><i class="fa fa-check"></i><b>2.1</b> Variables</a></li>
<li class="chapter" data-level="2.2" data-path="core.html"><a href="core.html#algorithms-and-functions"><i class="fa fa-check"></i><b>2.2</b> Algorithms and Functions</a></li>
<li class="chapter" data-level="2.3" data-path="core.html"><a href="core.html#libraries"><i class="fa fa-check"></i><b>2.3</b> Libraries</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="DS.html"><a href="DS.html"><i class="fa fa-check"></i><b>3</b> Data Structures</a>
<ul>
<li class="chapter" data-level="3.1" data-path="DS.html"><a href="DS.html#vectors"><i class="fa fa-check"></i><b>3.1</b> Vectors</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="DS.html"><a href="DS.html#vector-element-selection"><i class="fa fa-check"></i><b>3.1.1</b> Vector Element Selection</a></li>
<li class="chapter" data-level="3.1.2" data-path="DS.html"><a href="DS.html#using-the-range-function-with-vectors"><i class="fa fa-check"></i><b>3.1.2</b> Using the range() Function with Vectors</a></li>
<li class="chapter" data-level="3.1.3" data-path="DS.html"><a href="DS.html#applying-functions-to-vectors"><i class="fa fa-check"></i><b>3.1.3</b> Applying Functions to Vectors</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="DS.html"><a href="DS.html#multi-dimensional-data-types"><i class="fa fa-check"></i><b>3.2</b> Multi-dimensional Data Types</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="DS.html"><a href="DS.html#matrices"><i class="fa fa-check"></i><b>3.2.1</b> Matrices</a></li>
<li class="chapter" data-level="3.2.2" data-path="DS.html"><a href="DS.html#arrays"><i class="fa fa-check"></i><b>3.2.2</b> Arrays</a></li>
<li class="chapter" data-level="3.2.3" data-path="DS.html"><a href="DS.html#selection-in-multi-dimensional-data-types"><i class="fa fa-check"></i><b>3.2.3</b> Selection in Multi-Dimensional Data Types</a></li>
<li class="chapter" data-level="3.2.4" data-path="DS.html"><a href="DS.html#lists"><i class="fa fa-check"></i><b>3.2.4</b> Lists</a></li>
<li class="chapter" data-level="3.2.5" data-path="DS.html"><a href="DS.html#data-frame"><i class="fa fa-check"></i><b>3.2.5</b> Data Frame</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="spds.html"><a href="spds.html"><i class="fa fa-check"></i><b>4</b> Spatial Data Structures</a>
<ul>
<li class="chapter" data-level="4.1" data-path="spds.html"><a href="spds.html#vector-data-structures"><i class="fa fa-check"></i><b>4.1</b> Vector Data Structures</a></li>
<li class="chapter" data-level="4.2" data-path="spds.html"><a href="spds.html#raster-data-structures"><i class="fa fa-check"></i><b>4.2</b> Raster Data Structures</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="spds.html"><a href="spds.html#working-with-spatraster-objects"><i class="fa fa-check"></i><b>4.2.1</b> Working with SpatRaster objects</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="control-structures.html"><a href="control-structures.html"><i class="fa fa-check"></i><b>5</b> Control Structures</a>
<ul>
<li class="chapter" data-level="5.1" data-path="control-structures.html"><a href="control-structures.html#if"><i class="fa fa-check"></i><b>5.1</b> If</a></li>
<li class="chapter" data-level="5.2" data-path="control-structures.html"><a href="control-structures.html#else"><i class="fa fa-check"></i><b>5.2</b> Else</a></li>
<li class="chapter" data-level="5.3" data-path="control-structures.html"><a href="control-structures.html#code-blocks"><i class="fa fa-check"></i><b>5.3</b> Code blocks</a></li>
<li class="chapter" data-level="5.4" data-path="control-structures.html"><a href="control-structures.html#loops"><i class="fa fa-check"></i><b>5.4</b> Loops</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="control-structures.html"><a href="control-structures.html#while-and-repeat"><i class="fa fa-check"></i><b>5.4.1</b> While and repeat</a></li>
<li class="chapter" data-level="5.4.2" data-path="control-structures.html"><a href="control-structures.html#for"><i class="fa fa-check"></i><b>5.4.2</b> For</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="control-structures.html"><a href="control-structures.html#loops-with-conditional-statements"><i class="fa fa-check"></i><b>5.5</b> Loops with conditional statements</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="control-structures.html"><a href="control-structures.html#exercise-loops-with-conditional-statements"><i class="fa fa-check"></i><b>5.5.1</b> Exercise: loops with conditional statements</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>6</b> Functions</a>
<ul>
<li class="chapter" data-level="6.1" data-path="functions.html"><a href="functions.html#defining-functions"><i class="fa fa-check"></i><b>6.1</b> Defining Functions</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="functions.html"><a href="functions.html#understanding-the-return-function"><i class="fa fa-check"></i><b>6.1.1</b> Understanding the <code>return()</code> Function</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="functions.html"><a href="functions.html#more-parameters"><i class="fa fa-check"></i><b>6.2</b> More Parameters</a></li>
<li class="chapter" data-level="6.3" data-path="functions.html"><a href="functions.html#returning-multiple-values"><i class="fa fa-check"></i><b>6.3</b> Returning Multiple Values</a></li>
<li class="chapter" data-level="6.4" data-path="functions.html"><a href="functions.html#functions-and-control-structures"><i class="fa fa-check"></i><b>6.4</b> Functions and Control Structures</a></li>
<li class="chapter" data-level="6.5" data-path="functions.html"><a href="functions.html#scope"><i class="fa fa-check"></i><b>6.5</b> Scope</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="datman.html"><a href="datman.html"><i class="fa fa-check"></i><b>7</b> Data Manipulation</a>
<ul>
<li class="chapter" data-level="7.1" data-path="datman.html"><a href="datman.html#preparation"><i class="fa fa-check"></i><b>7.1</b> Preparation</a></li>
<li class="chapter" data-level="7.2" data-path="datman.html"><a href="datman.html#data-manipulation"><i class="fa fa-check"></i><b>7.2</b> Data manipulation</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="datman.html"><a href="datman.html#summarise"><i class="fa fa-check"></i><b>7.2.1</b> Summarise</a></li>
<li class="chapter" data-level="7.2.2" data-path="datman.html"><a href="datman.html#select-and-filter"><i class="fa fa-check"></i><b>7.2.2</b> Select and filter</a></li>
<li class="chapter" data-level="7.2.3" data-path="datman.html"><a href="datman.html#mutate"><i class="fa fa-check"></i><b>7.2.3</b> Mutate</a></li>
<li class="chapter" data-level="7.2.4" data-path="datman.html"><a href="datman.html#arrange"><i class="fa fa-check"></i><b>7.2.4</b> Arrange</a></li>
<li class="chapter" data-level="7.2.5" data-path="datman.html"><a href="datman.html#exercise-data-manipulation"><i class="fa fa-check"></i><b>7.2.5</b> Exercise: data manipulation</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="datman.html"><a href="datman.html#join"><i class="fa fa-check"></i><b>7.3</b> Join</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="datman.html"><a href="datman.html#exercise-join"><i class="fa fa-check"></i><b>7.3.1</b> Exercise: join</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="readwrite.html"><a href="readwrite.html"><i class="fa fa-check"></i><b>8</b> Read and Write Data</a>
<ul>
<li class="chapter" data-level="8.1" data-path="readwrite.html"><a href="readwrite.html#read-and-write-tabular-data"><i class="fa fa-check"></i><b>8.1</b> Read and write tabular data</a></li>
<li class="chapter" data-level="8.2" data-path="readwrite.html"><a href="readwrite.html#read-and-write-vector-data"><i class="fa fa-check"></i><b>8.2</b> Read and write vector data</a></li>
<li class="chapter" data-level="8.3" data-path="readwrite.html"><a href="readwrite.html#read-and-write-raster-data"><i class="fa fa-check"></i><b>8.3</b> Read and write raster data</a></li>
<li class="chapter" data-level="8.4" data-path="readwrite.html"><a href="readwrite.html#data-api"><i class="fa fa-check"></i><b>8.4</b> Data API</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="spm.html"><a href="spm.html"><i class="fa fa-check"></i><b>9</b> Spatial Data Manipulation</a>
<ul>
<li class="chapter" data-level="9.1" data-path="spm.html"><a href="spm.html#data-acquisition"><i class="fa fa-check"></i><b>9.1</b> Data Acquisition</a></li>
<li class="chapter" data-level="9.2" data-path="spm.html"><a href="spm.html#data-cleaning"><i class="fa fa-check"></i><b>9.2</b> Data Cleaning</a></li>
<li class="chapter" data-level="9.3" data-path="spm.html"><a href="spm.html#vector-operations"><i class="fa fa-check"></i><b>9.3</b> Vector operations</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="spm.html"><a href="spm.html#geometrical-operations"><i class="fa fa-check"></i><b>9.3.1</b> Geometrical operations</a></li>
<li class="chapter" data-level="9.3.2" data-path="spm.html"><a href="spm.html#binary-operations"><i class="fa fa-check"></i><b>9.3.2</b> Binary operations</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="spm.html"><a href="spm.html#raster-operations"><i class="fa fa-check"></i><b>9.4</b> Raster operations</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="spm.html"><a href="spm.html#resampling"><i class="fa fa-check"></i><b>9.4.1</b> Resampling</a></li>
<li class="chapter" data-level="9.4.2" data-path="spm.html"><a href="spm.html#crop-raster"><i class="fa fa-check"></i><b>9.4.2</b> Crop raster</a></li>
<li class="chapter" data-level="9.4.3" data-path="spm.html"><a href="spm.html#raster-algebra"><i class="fa fa-check"></i><b>9.4.3</b> Raster algebra</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="data-viz.html"><a href="data-viz.html"><i class="fa fa-check"></i><b>10</b> Data Visualization</a>
<ul>
<li class="chapter" data-level="10.1" data-path="data-viz.html"><a href="data-viz.html#the-grammar-of-graphics"><i class="fa fa-check"></i><b>10.1</b> The Grammar of Graphics</a></li>
<li class="chapter" data-level="10.2" data-path="data-viz.html"><a href="data-viz.html#understanding-wide-and-long-data-formats-in-r"><i class="fa fa-check"></i><b>10.2</b> Understanding Wide and Long Data Formats in R</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="data-viz.html"><a href="data-viz.html#wide-format"><i class="fa fa-check"></i><b>10.2.1</b> Wide format</a></li>
<li class="chapter" data-level="10.2.2" data-path="data-viz.html"><a href="data-viz.html#long-format"><i class="fa fa-check"></i><b>10.2.2</b> Long format:</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="data-viz.html"><a href="data-viz.html#visualization-of-distributions"><i class="fa fa-check"></i><b>10.3</b> Visualization of distributions</a></li>
<li class="chapter" data-level="10.4" data-path="data-viz.html"><a href="data-viz.html#boxplots"><i class="fa fa-check"></i><b>10.4</b> Boxplots</a></li>
<li class="chapter" data-level="10.5" data-path="data-viz.html"><a href="data-viz.html#scatterplots"><i class="fa fa-check"></i><b>10.5</b> Scatterplots</a></li>
<li class="chapter" data-level="10.6" data-path="data-viz.html"><a href="data-viz.html#map-visualization"><i class="fa fa-check"></i><b>10.6</b> Map Visualization</a></li>
<li class="chapter" data-level="10.7" data-path="data-viz.html"><a href="data-viz.html#interactive-maps"><i class="fa fa-check"></i><b>10.7</b> Interactive Maps</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="r-markdown.html"><a href="r-markdown.html"><i class="fa fa-check"></i><b>11</b> R Markdown</a>
<ul>
<li class="chapter" data-level="11.1" data-path="r-markdown.html"><a href="r-markdown.html#set-up-your-work-environment"><i class="fa fa-check"></i><b>11.1</b> Set up your work environment</a></li>
<li class="chapter" data-level="11.2" data-path="r-markdown.html"><a href="r-markdown.html#create-a-local-clone"><i class="fa fa-check"></i><b>11.2</b> Create a local clone</a></li>
<li class="chapter" data-level="11.3" data-path="r-markdown.html"><a href="r-markdown.html#creating-your-first-r-markdown-document"><i class="fa fa-check"></i><b>11.3</b> Creating Your First R Markdown Document</a></li>
<li class="chapter" data-level="11.4" data-path="r-markdown.html"><a href="r-markdown.html#synchronizing-with-github"><i class="fa fa-check"></i><b>11.4</b> Synchronizing with GitHub</a></li>
<li class="chapter" data-level="11.5" data-path="r-markdown.html"><a href="r-markdown.html#basic-r-markdown-syntax"><i class="fa fa-check"></i><b>11.5</b> Basic R Markdown Syntax</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="r-markdown.html"><a href="r-markdown.html#references-in-rmarkdown"><i class="fa fa-check"></i><b>11.5.1</b> References in RMarkdown</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="r-markdown.html"><a href="r-markdown.html#speed-up-your-workflows"><i class="fa fa-check"></i><b>11.6</b> Speed up your workflows</a></li>
<li class="chapter" data-level="11.7" data-path="r-markdown.html"><a href="r-markdown.html#self-study"><i class="fa fa-check"></i><b>11.7</b> Self-study</a></li>
</ul></li>
<li class="divider"></li>
<li>Copyright © UNIGIS Salzburg.</li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Automated Data Processing with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-viz" class="section level1 hasAnchor" number="10">
<h1><span class="header-section-number">Lesson 10</span> Data Visualization<a href="data-viz.html#data-viz" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>R has a very rich set of graphical functions. The <a href="https://www.r-graph-gallery.com/" target="_blank">R Graph Gallery</a> provides a large number of examples (including code).</p>

<div class="rmdtip">
In this lesson you will get to know the <a href="https://ggplot2.tidyverse.org/" target="_blank"><code>ggplot2</code> library</a>, which is the most popular library for creating graphics in R. You will learn to create standard graphs such as histograms, boxplots or scatterplots as well as maps by means of the <a href="https://ggplot2.tidyverse.org/" target="_blank"><code>ggplot2</code> library</a>.
</div>
<div id="the-grammar-of-graphics" class="section level2 hasAnchor" number="10.1">
<h2><span class="header-section-number">10.1</span> The Grammar of Graphics<a href="data-viz.html#the-grammar-of-graphics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The <a href="https://ggplot2.tidyverse.org/" target="_blank"><code>ggplot2</code></a> library, a part of the Tidyverse suite, is renowned for its comprehensive and intuitive approach to data visualization in R. Rooted in the principles of “The Grammar of Graphics”, conceptualized by <a href="https://en.wikipedia.org/wiki/Leland_Wilkinson" target="_blank">Leland Wilkinson</a>, <code>ggplot2</code> enables users to construct graphics through a layered approach, incorporating seven distinct elements:</p>
<p>“The Grammar of Graphics” is a schema that enables us to concisely describe the components of a graphic. These components are called <strong>layers of grammatical elements.</strong> Overall, the grammar comprises seven layers:</p>
<ol style="list-style-type: decimal">
<li><strong>Data:</strong> The core dataset to be visualized.</li>
<li><strong>Aesthetics:</strong> Mappings of variables to visual scales, like color or size.</li>
<li><strong>Geometries:</strong> The visual representation of data, such as points, lines, or bars.</li>
<li><strong>Facets:</strong> Creating subsets of data to generate similar graphs for each subset.</li>
<li><strong>Statistics:</strong> Applying statistical transformations to data (mean, median, etc.).</li>
<li><strong>Coordinates:</strong> Managing axes and spatial transformation.</li>
<li><strong>Themes:</strong> Customizing the graphical backdrop for enhanced visual appeal.</li>
</ol>
<p>In essence, these layers enable a structured and flexible approach to crafting visual narratives from data. For instance, the visual variables such as size, shape, and color offer nuanced ways to represent and differentiate data points.</p>
<p>In the example below, ‘Gdp per capita’ and ‘Life Expectancy’ align with the x and y axes, respectively, and ‘national population’ and ‘world regions’ are differentiated by size and color.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:L07-colsize"></span>
<img src="images/VisualVar.png" alt="Visual variables color and size in a `ggplot2` graph" width="90%" />
<p class="caption">
Figure 10.1: Visual variables color and size in a <code>ggplot2</code> graph
</p>
</div>
<p>Upcoming sections will delve into practical examples, demonstrating the power and versatility of <code>ggplot2</code> in visualizing complex datasets.</p>

<div class="rmdtip">
<strong>Further Reading:</strong> For a foundational understanding of “The Grammar of Graphics” as implemented in <code>ggplot2</code>, refer to Hadley Wickham’s insightful <a href="https://byrneslab.net/classes/biol607/readings/wickham_layered-grammar.pdf" target="_blank">article</a>.
</div>
</div>
<div id="understanding-wide-and-long-data-formats-in-r" class="section level2 hasAnchor" number="10.2">
<h2><span class="header-section-number">10.2</span> Understanding Wide and Long Data Formats in R<a href="data-viz.html#understanding-wide-and-long-data-formats-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>When working with data in R, especially for visualization purposes, it’s crucial to understand the structure of your dataset. Typically, datasets can be categorized into two main formats: <strong>Wide</strong> and <strong>Long</strong> (also known as <strong>Tidy</strong>) formats. The format of your data can significantly impact how you manipulate and visualize it.</p>
<div id="wide-format" class="section level3 hasAnchor" number="10.2.1">
<h3><span class="header-section-number">10.2.1</span> Wide format<a href="data-viz.html#wide-format" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><strong>Characteristics:</strong> In a wide-format dataset, each subject or entity (such as a city) is represented once, with multiple columns for different variables or time periods.</li>
<li><strong>Example:</strong> Consider a dataset representing annual rainfall measurements across different cities, measured in millimeters (mm). In this wide format, each row corresponds to a city, and the columns represent rainfall measurements for different years.</li>
</ul>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="data-viz.html#cb255-1" tabindex="-1"></a><span class="co"># Example of a wide format dataset</span></span>
<span id="cb255-2"><a href="data-viz.html#cb255-2" tabindex="-1"></a>wide_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb255-3"><a href="data-viz.html#cb255-3" tabindex="-1"></a>  <span class="at">City =</span> <span class="fu">c</span>(<span class="st">&quot;CityA&quot;</span>, <span class="st">&quot;CityB&quot;</span>, <span class="st">&quot;CityC&quot;</span>, <span class="st">&quot;CityD&quot;</span>, <span class="st">&quot;CityE&quot;</span>),</span>
<span id="cb255-4"><a href="data-viz.html#cb255-4" tabindex="-1"></a>  <span class="at">Rainfall_2015 =</span> <span class="fu">c</span>(<span class="dv">600</span>, <span class="dv">500</span>, <span class="dv">550</span>, <span class="dv">450</span>, <span class="dv">400</span>),</span>
<span id="cb255-5"><a href="data-viz.html#cb255-5" tabindex="-1"></a>  <span class="at">Rainfall_2016 =</span> <span class="fu">c</span>(<span class="dv">650</span>, <span class="dv">550</span>, <span class="dv">600</span>, <span class="dv">500</span>, <span class="dv">450</span>)</span>
<span id="cb255-6"><a href="data-viz.html#cb255-6" tabindex="-1"></a>)</span>
<span id="cb255-7"><a href="data-viz.html#cb255-7" tabindex="-1"></a></span>
<span id="cb255-8"><a href="data-viz.html#cb255-8" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(wide_data)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">City</th>
<th align="right">Rainfall_2015</th>
<th align="right">Rainfall_2016</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">CityA</td>
<td align="right">600</td>
<td align="right">650</td>
</tr>
<tr class="even">
<td align="left">CityB</td>
<td align="right">500</td>
<td align="right">550</td>
</tr>
<tr class="odd">
<td align="left">CityC</td>
<td align="right">550</td>
<td align="right">600</td>
</tr>
<tr class="even">
<td align="left">CityD</td>
<td align="right">450</td>
<td align="right">500</td>
</tr>
<tr class="odd">
<td align="left">CityE</td>
<td align="right">400</td>
<td align="right">450</td>
</tr>
</tbody>
</table>
</div>
<div id="long-format" class="section level3 hasAnchor" number="10.2.2">
<h3><span class="header-section-number">10.2.2</span> Long format:<a href="data-viz.html#long-format" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><strong>Characteristics:</strong> In a long-format dataset, each row is a single observation for a single variable, often requiring multiple rows per subject or unit</li>
<li><strong>Example:</strong> Using the same rainfall dataset, a long format would list each year’s rainfall for each city as a separate row.</li>
</ul>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="data-viz.html#cb256-1" tabindex="-1"></a><span class="co"># Example of long-format data:</span></span>
<span id="cb256-2"><a href="data-viz.html#cb256-2" tabindex="-1"></a>long_data <span class="ot">&lt;-</span> tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>( </span>
<span id="cb256-3"><a href="data-viz.html#cb256-3" tabindex="-1"></a>  wide_data,</span>
<span id="cb256-4"><a href="data-viz.html#cb256-4" tabindex="-1"></a>  <span class="at">cols =</span> <span class="sc">-</span>City, </span>
<span id="cb256-5"><a href="data-viz.html#cb256-5" tabindex="-1"></a>  <span class="at">names_to =</span> <span class="st">&quot;Year&quot;</span>, </span>
<span id="cb256-6"><a href="data-viz.html#cb256-6" tabindex="-1"></a>  <span class="at">values_to =</span> <span class="st">&quot;Rainfall&quot;</span></span>
<span id="cb256-7"><a href="data-viz.html#cb256-7" tabindex="-1"></a>)</span>
<span id="cb256-8"><a href="data-viz.html#cb256-8" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(long_data)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">City</th>
<th align="left">Year</th>
<th align="right">Rainfall</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">CityA</td>
<td align="left">Rainfall_2015</td>
<td align="right">600</td>
</tr>
<tr class="even">
<td align="left">CityA</td>
<td align="left">Rainfall_2016</td>
<td align="right">650</td>
</tr>
<tr class="odd">
<td align="left">CityB</td>
<td align="left">Rainfall_2015</td>
<td align="right">500</td>
</tr>
<tr class="even">
<td align="left">CityB</td>
<td align="left">Rainfall_2016</td>
<td align="right">550</td>
</tr>
<tr class="odd">
<td align="left">CityC</td>
<td align="left">Rainfall_2015</td>
<td align="right">550</td>
</tr>
<tr class="even">
<td align="left">CityC</td>
<td align="left">Rainfall_2016</td>
<td align="right">600</td>
</tr>
<tr class="odd">
<td align="left">CityD</td>
<td align="left">Rainfall_2015</td>
<td align="right">450</td>
</tr>
<tr class="even">
<td align="left">CityD</td>
<td align="left">Rainfall_2016</td>
<td align="right">500</td>
</tr>
<tr class="odd">
<td align="left">CityE</td>
<td align="left">Rainfall_2015</td>
<td align="right">400</td>
</tr>
<tr class="even">
<td align="left">CityE</td>
<td align="left">Rainfall_2016</td>
<td align="right">450</td>
</tr>
</tbody>
</table>
<p>Understanding these formats is crucial for effective data manipulation and visualization in R, especially when using libraries like <code>ggplot2</code> and <code>tidyverse</code>. Certain types of visualizations and statistical analyses are more straightforward with data in a specific format.</p>

<div class="rmdtip">
<strong>Note</strong>: Transforming data between wide and long formats is often achieved using functions like <code>pivot_longer()</code> and <code>pivot_wider()</code> from the <a href="https://tidyr.tidyverse.org/reference/index.html" target="_blank"><code>tidyr</code></a> package, which is in included in the Tidyverse.
</div>
</div>
</div>
<div id="visualization-of-distributions" class="section level2 hasAnchor" number="10.3">
<h2><span class="header-section-number">10.3</span> Visualization of distributions<a href="data-viz.html#visualization-of-distributions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As already mentioned above, functions in the <code>ggplot2</code> library are structured according to “The Grammar of Graphics”. When creating graphs with <code>ggplot2</code>, we start by setting up data and aesthetics (<code>aes()</code>), then defining the type of plot (geometry) like <code>geom_point</code>, and finally enhancing the plot with additional transformations and themes.</p>
<p>We begin the analysis with a simple histogram, to explore the distribution of air quality <a href="data/AirQualityUpperAut.csv" target="_blank"><strong>data</strong></a> that has been measured at different locations in Upper Austria, one of the nine states in Austria.</p>

<div class="rmdtip">
<p><strong>Data Overview:</strong></p>
<ul>
<li><p><strong>Time:</strong> Timestamp of each measurement.</p></li>
<li><p><strong>Station:</strong> Identifier for the measurement station.</p></li>
<li><p><strong><a href="data/MetadataAirqual.xlsx" target="_blank">Component</a>:</strong> The air quality component measured.</p></li>
<li><p><strong><a href="data/MetadataAirqual2.xlsx" target="_blank">Meantype</a>:</strong> The temporal resolution of measurements.</p></li>
<li><p><strong>Unit:</strong> The unit of measurement.</p></li>
<li><p><strong>Value:</strong> The measured value of air quality.</p>
</div></li>
</ul>
<p>Let’s start by displaying the first few rows of this dataset:</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="data-viz.html#cb257-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb257-2"><a href="data-viz.html#cb257-2" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb257-3"><a href="data-viz.html#cb257-3" tabindex="-1"></a></span>
<span id="cb257-4"><a href="data-viz.html#cb257-4" tabindex="-1"></a><span class="co"># Read the dataset (Note: Semi-colon separated)</span></span>
<span id="cb257-5"><a href="data-viz.html#cb257-5" tabindex="-1"></a>airquality <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="st">&quot;data/AirQualityUpperAut.csv&quot;</span>, <span class="at">delim =</span> <span class="st">&quot;;&quot;</span>)</span>
<span id="cb257-6"><a href="data-viz.html#cb257-6" tabindex="-1"></a></span>
<span id="cb257-7"><a href="data-viz.html#cb257-7" tabindex="-1"></a><span class="co"># Display the first five rows</span></span>
<span id="cb257-8"><a href="data-viz.html#cb257-8" tabindex="-1"></a>airquality <span class="sc">%&gt;%</span></span>
<span id="cb257-9"><a href="data-viz.html#cb257-9" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb257-10"><a href="data-viz.html#cb257-10" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">time</th>
<th align="left">station</th>
<th align="left">component</th>
<th align="left">meantype</th>
<th align="left">unit</th>
<th align="right">value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">21.10.2021 13:30</td>
<td align="left">C001</td>
<td align="left">BOE</td>
<td align="left">HMW</td>
<td align="left">m/s</td>
<td align="right">14.1</td>
</tr>
<tr class="even">
<td align="left">21.10.2021 14:00</td>
<td align="left">C001</td>
<td align="left">BOE</td>
<td align="left">HMW</td>
<td align="left">m/s</td>
<td align="right">12.0</td>
</tr>
<tr class="odd">
<td align="left">21.10.2021 14:30</td>
<td align="left">C001</td>
<td align="left">BOE</td>
<td align="left">HMW</td>
<td align="left">m/s</td>
<td align="right">10.1</td>
</tr>
<tr class="even">
<td align="left">21.10.2021 15:00</td>
<td align="left">C001</td>
<td align="left">BOE</td>
<td align="left">HMW</td>
<td align="left">m/s</td>
<td align="right">7.9</td>
</tr>
<tr class="odd">
<td align="left">21.10.2021 15:30</td>
<td align="left">C001</td>
<td align="left">BOE</td>
<td align="left">HMW</td>
<td align="left">m/s</td>
<td align="right">9.2</td>
</tr>
</tbody>
</table>
<p>The code below filters the airquality dataset by measurement component and temporal resolution. Then the data subset is passed as a first argument to function <code>ggplot()</code>. In the second argument, we map the variable <code>value</code> onto the x-axis with the aesthetics argument <code>aes()</code>. <code>geom_histogram()</code> specifies the geometry of the plot and <code>theme_bw()</code> is used to add a <a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" target="_blank">background theme</a>.</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="data-viz.html#cb258-1" tabindex="-1"></a><span class="co"># filter NO2 measurements with temporal resolution 30min (HMW)</span></span>
<span id="cb258-2"><a href="data-viz.html#cb258-2" tabindex="-1"></a>airquality <span class="sc">%&gt;%</span></span>
<span id="cb258-3"><a href="data-viz.html#cb258-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(component <span class="sc">==</span> <span class="st">&quot;NO2&quot;</span> <span class="sc">&amp;</span> meantype <span class="sc">==</span> <span class="st">&quot;HMW&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb258-4"><a href="data-viz.html#cb258-4" tabindex="-1"></a></span>
<span id="cb258-5"><a href="data-viz.html#cb258-5" tabindex="-1"></a>  <span class="co"># create plot  </span></span>
<span id="cb258-6"><a href="data-viz.html#cb258-6" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(.,    <span class="co"># the dot &#39;.&#39; represents the piped value </span></span>
<span id="cb258-7"><a href="data-viz.html#cb258-7" tabindex="-1"></a>    <span class="fu">aes</span>(            </span>
<span id="cb258-8"><a href="data-viz.html#cb258-8" tabindex="-1"></a>      <span class="at">x =</span> value         <span class="co"># map variable &#39;value&#39; onto x-axis</span></span>
<span id="cb258-9"><a href="data-viz.html#cb258-9" tabindex="-1"></a>    )</span>
<span id="cb258-10"><a href="data-viz.html#cb258-10" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb258-11"><a href="data-viz.html#cb258-11" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_histogram</span>() <span class="sc">+</span>    <span class="co"># define geometry</span></span>
<span id="cb258-12"><a href="data-viz.html#cb258-12" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()            <span class="co"># define theme</span></span></code></pre></div>
<p><img src="UNIGIS-AppDev-R_files/figure-html/unnamed-chunk-219-1.png" width="672" /></p>
<p>To differentiate between measurements from various stations, we can map the <code>station</code> variable to the color attribute:</p>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="data-viz.html#cb259-1" tabindex="-1"></a>airquality <span class="sc">%&gt;%</span></span>
<span id="cb259-2"><a href="data-viz.html#cb259-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(component <span class="sc">==</span> <span class="st">&quot;NO2&quot;</span> <span class="sc">&amp;</span> meantype <span class="sc">==</span> <span class="st">&quot;HMW&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb259-3"><a href="data-viz.html#cb259-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(station <span class="sc">==</span> <span class="st">&quot;S125&quot;</span> <span class="sc">|</span> station <span class="sc">==</span> <span class="st">&quot;S431&quot;</span> <span class="sc">|</span> station <span class="sc">==</span> <span class="st">&quot;S270&quot;</span>) <span class="sc">%&gt;%</span>    <span class="co"># select 3 stations</span></span>
<span id="cb259-4"><a href="data-viz.html#cb259-4" tabindex="-1"></a></span>
<span id="cb259-5"><a href="data-viz.html#cb259-5" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(.,    </span>
<span id="cb259-6"><a href="data-viz.html#cb259-6" tabindex="-1"></a>    <span class="fu">aes</span>(            </span>
<span id="cb259-7"><a href="data-viz.html#cb259-7" tabindex="-1"></a>      <span class="at">x =</span> value, </span>
<span id="cb259-8"><a href="data-viz.html#cb259-8" tabindex="-1"></a>      <span class="at">fill =</span> station</span>
<span id="cb259-9"><a href="data-viz.html#cb259-9" tabindex="-1"></a>      </span>
<span id="cb259-10"><a href="data-viz.html#cb259-10" tabindex="-1"></a>    )</span>
<span id="cb259-11"><a href="data-viz.html#cb259-11" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb259-12"><a href="data-viz.html#cb259-12" tabindex="-1"></a>  </span>
<span id="cb259-13"><a href="data-viz.html#cb259-13" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">xlab</span>(<span class="st">&quot;NO2 [mg/m^3]&quot;</span>) <span class="sc">+</span> <span class="co"># add x-axis label</span></span>
<span id="cb259-14"><a href="data-viz.html#cb259-14" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ylab</span>(<span class="st">&quot;Count&quot;</span>) <span class="sc">+</span>        <span class="co"># add y-axis label</span></span>
<span id="cb259-15"><a href="data-viz.html#cb259-15" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">&quot;Measurement stations&quot;</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;grey20&quot;</span>, <span class="st">&quot;grey50&quot;</span>, <span class="st">&quot;grey80&quot;</span>)) <span class="sc">+</span> <span class="co"># add legend</span></span>
<span id="cb259-16"><a href="data-viz.html#cb259-16" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_histogram</span>() <span class="sc">+</span>   </span>
<span id="cb259-17"><a href="data-viz.html#cb259-17" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()            </span></code></pre></div>
<p><img src="UNIGIS-AppDev-R_files/figure-html/unnamed-chunk-220-1.png" width="672" /></p>
<p>This is implemented by adding an attribute <code>fill = station</code> to the aesthetics element (<code>aes()</code>). <code>ggplot2</code> offers a number of <a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" target="_blank">functions</a> to specify your own set of mappings from levels in the data to aesthetic values. In the example above the function <code>scale_fill_manual()</code> is used to map the three levels <code>S125</code>, <code>S270</code> and <code>S431</code> to the fill <a href="http://sape.inf.usi.ch/quick-reference/ggplot2/colour" target="_blank">colors</a> <code>grey20</code>, <code>grey50</code> and <code>grey80</code>. Instead of ‘ggplot colors’, you can also use <a href="https://htmlcolorcodes.com/" target="_blank">hex color codes</a>.</p>

<div class="rmdexercise">
<p>Note that plot components are <a href="https://ggplot2.tidyverse.org/reference/gg-add.html" target="_blank">added</a> by means of a plus ‘+’ sign. It allows you to start simple, and then get more and more complex.</p>
<p>So far, we have added two axis labels. Create a new R-Script, download the <a href="data/AirQualityUpperAut.csv" target="_blank">input data</a>, recreate the histogram and insert one additional line of code to add a plot title (see <a href="https://ggplot2.tidyverse.org/reference/labs.html" target="_blank">documentation</a>).</p>
<details closed>
<summary>
<ins>
<strong>See the solution!</strong>
</ins>
</summary>
<p>
<p><font color="grey"></p>
<p>Insert a title by adding:</p>
<p>ggplot2::ggtitle(“Nitrogen dioxide concentration”)</p>
</font>
</p>
</details>
</div>
</div>
<div id="boxplots" class="section level2 hasAnchor" number="10.4">
<h2><span class="header-section-number">10.4</span> Boxplots<a href="data-viz.html#boxplots" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The same basic syntax is used to create other types of plots like bar plots (use geometry <a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" target="_blank"><code>geom_bar()</code></a> or <a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" target="_blank"><code>geom_col()</code></a>, line plots (use geometry <a href="https://ggplot2.tidyverse.org/reference/geom_path.html" target="_blank"><code>geom_line()</code></a>) and many <a href="https://ggplot2.tidyverse.org/reference/index.html" target="_blank">others</a>.</p>
<p>For instance, if we replace <code>geom_histogram()</code> by <code>geom_boxplot()</code>, the value distribution of NO2 measurements is visualized by means of a box plot:</p>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="data-viz.html#cb260-1" tabindex="-1"></a><span class="co"># filter NO2 measurements with temporal resolution 30min (HMW)</span></span>
<span id="cb260-2"><a href="data-viz.html#cb260-2" tabindex="-1"></a>airquality <span class="sc">%&gt;%</span></span>
<span id="cb260-3"><a href="data-viz.html#cb260-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(component <span class="sc">==</span> <span class="st">&quot;NO2&quot;</span> <span class="sc">&amp;</span> meantype <span class="sc">==</span> <span class="st">&quot;HMW&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb260-4"><a href="data-viz.html#cb260-4" tabindex="-1"></a></span>
<span id="cb260-5"><a href="data-viz.html#cb260-5" tabindex="-1"></a>  <span class="co"># create plot  </span></span>
<span id="cb260-6"><a href="data-viz.html#cb260-6" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(.,    <span class="co"># the dot &#39;.&#39; represents the piped value </span></span>
<span id="cb260-7"><a href="data-viz.html#cb260-7" tabindex="-1"></a>    <span class="fu">aes</span>(            </span>
<span id="cb260-8"><a href="data-viz.html#cb260-8" tabindex="-1"></a>      <span class="at">x =</span> value         <span class="co"># map variable &#39;value&#39; onto x-axis</span></span>
<span id="cb260-9"><a href="data-viz.html#cb260-9" tabindex="-1"></a>    )</span>
<span id="cb260-10"><a href="data-viz.html#cb260-10" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb260-11"><a href="data-viz.html#cb260-11" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">xlab</span>(<span class="st">&quot;NO2 [mg/m^3]&quot;</span>) <span class="sc">+</span></span>
<span id="cb260-12"><a href="data-viz.html#cb260-12" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_boxplot</span>() <span class="sc">+</span>    <span class="co"># define geometry</span></span>
<span id="cb260-13"><a href="data-viz.html#cb260-13" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(</span>
<span id="cb260-14"><a href="data-viz.html#cb260-14" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),    <span class="co"># remove text and ticks from y axis</span></span>
<span id="cb260-15"><a href="data-viz.html#cb260-15" tabindex="-1"></a>    <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>()</span>
<span id="cb260-16"><a href="data-viz.html#cb260-16" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="UNIGIS-AppDev-R_files/figure-html/unnamed-chunk-222-1.png" width="672" /></p>
<p><strong>Note that:</strong> the last two lines remove text and tick marks from the y-axis of the plot.</p>

<div class="rmdtip">
<p>Just as histograms, box plots are used to inspect distributions in data. The <a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" target="_blank">interpretation</a>, however, does require some additional information.</p>
<p>The lower and upper edge of the box (the so-called lower and upper <strong>hinges</strong>) correspond to the first and third <a href="https://www.statisticshowto.com/probability-and-statistics/statistics-definitions/what-are-quartiles/" target="_blank">quartiles</a>. The vertical line that separates the box indicates the <strong>median</strong> value (second quartile).</p>
<p>The upper <strong>whisker</strong> extends from the hinge to the largest value no further than 1.5 * IQR from the hinge (where IQR is the inter-quartile range, or distance between the first and third quartiles). The lower whisker extends from the hinge to the smallest value at most 1.5 * IQR of the hinge. Data beyond the end of the whiskers are called “outlying” points and are plotted individually.</p>
</div>

<div class="rmdexercise">
<p>In our histogram examples, we have mapped the variable ‘station’ onto visual variable <code>color</code> to separately visualize measurements of different stations. Try to apply the same approach to render measurements of stations <code>S125</code>, <code>S270</code> and <code>S431</code> separately in a box plot.</p>
See <a href="Solution_Exercise_boxplots.R" target="_blank">our solution</a>!
</div>
</div>
<div id="scatterplots" class="section level2 hasAnchor" number="10.5">
<h2><span class="header-section-number">10.5</span> Scatterplots<a href="data-viz.html#scatterplots" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Scatterplots serve as a pivotal tool in statistical analysis, particularly when it comes to exploring the interplay between two variables. Their strength lies in visually capturing the nature and strength of relationships.</p>
<p>Consider the scenario where we seek to understand the relationship between air temperature (<code>TEMP</code>) and relative humidity (<code>RF</code>). For this purpose, we delve into the <code>airquality</code> dataset, focusing on half-hourly readings from station <code>S108</code>. Our objective is to juxtapose the temperature and humidity readings and analyze their correlation.</p>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="data-viz.html#cb261-1" tabindex="-1"></a><span class="co"># Extract half-hourly temperature readings from station S108</span></span>
<span id="cb261-2"><a href="data-viz.html#cb261-2" tabindex="-1"></a>temp_tab <span class="ot">&lt;-</span> airquality <span class="sc">%&gt;%</span></span>
<span id="cb261-3"><a href="data-viz.html#cb261-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(component <span class="sc">==</span> <span class="st">&quot;TEMP&quot;</span>, meantype <span class="sc">==</span> <span class="st">&quot;HMW&quot;</span>, station <span class="sc">==</span> <span class="st">&quot;S108&quot;</span>) </span>
<span id="cb261-4"><a href="data-viz.html#cb261-4" tabindex="-1"></a></span>
<span id="cb261-5"><a href="data-viz.html#cb261-5" tabindex="-1"></a><span class="co"># Similarly, extract half-hourly humidity readings</span></span>
<span id="cb261-6"><a href="data-viz.html#cb261-6" tabindex="-1"></a>humidity_tab <span class="ot">&lt;-</span> airquality <span class="sc">%&gt;%</span></span>
<span id="cb261-7"><a href="data-viz.html#cb261-7" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(component <span class="sc">==</span> <span class="st">&quot;RF&quot;</span>, meantype <span class="sc">==</span> <span class="st">&quot;HMW&quot;</span>, station <span class="sc">==</span> <span class="st">&quot;S108&quot;</span>) </span>
<span id="cb261-8"><a href="data-viz.html#cb261-8" tabindex="-1"></a></span>
<span id="cb261-9"><a href="data-viz.html#cb261-9" tabindex="-1"></a><span class="co"># Join the two datasets on &#39;time&#39;</span></span>
<span id="cb261-10"><a href="data-viz.html#cb261-10" tabindex="-1"></a>temp_humidity_joined <span class="ot">&lt;-</span> temp_tab <span class="sc">%&gt;%</span></span>
<span id="cb261-11"><a href="data-viz.html#cb261-11" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">inner_join</span>(humidity_tab, <span class="at">by =</span> <span class="st">&quot;time&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb261-12"><a href="data-viz.html#cb261-12" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(time, value.x, value.y) </span>
<span id="cb261-13"><a href="data-viz.html#cb261-13" tabindex="-1"></a></span>
<span id="cb261-14"><a href="data-viz.html#cb261-14" tabindex="-1"></a><span class="co"># Create the scatterplot</span></span>
<span id="cb261-15"><a href="data-viz.html#cb261-15" tabindex="-1"></a><span class="fu">ggplot</span>(temp_humidity_joined, <span class="fu">aes</span>(<span class="at">x =</span> value.x, <span class="at">y =</span> value.y)) <span class="sc">+</span></span>
<span id="cb261-16"><a href="data-viz.html#cb261-16" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Air Temperature [°C]&quot;</span>) <span class="sc">+</span></span>
<span id="cb261-17"><a href="data-viz.html#cb261-17" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Relative Humidity [%]&quot;</span>) <span class="sc">+</span></span>
<span id="cb261-18"><a href="data-viz.html#cb261-18" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb261-19"><a href="data-viz.html#cb261-19" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;#69b3a2&quot;</span>, <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb261-20"><a href="data-viz.html#cb261-20" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()          </span></code></pre></div>
<p><img src="UNIGIS-AppDev-R_files/figure-html/unnamed-chunk-225-1.png" width="672" /></p>
<p>The generated scatterplot vividly illustrates the relationship between air temperature and relative humidity. Typically, as the temperature drops, the relative humidity tends to rise, and vice versa. This inverse relationship, although not strictly linear, can be approximated using a linear regression model. Deviations from this model are captured within a 95% confidence interval, providing a more nuanced understanding of the data dynamics.</p>
<p>For a comprehensive explanation of the inverse relationship between relative humidity and temperature, refer to <a href="https://www.youtube.com/watch?v=saojnBSBUuk" target="_blank">this video</a></p>

<div class="rmdexercise">
<p>Copy and run the code example from above in a new R-Script. Note that the air quality data as well as the <code>tidyverse</code> library must be loaded to run the code in a standalone R-script file.</p>
<p><a href="Solution_Scatterplot.R" target="_blank">Complete Script!</a></p>
<p>While exploring, consider the following:</p>
<ol style="list-style-type: decimal">
<li>How many individual measurements are visualized in the scatterplot?</li>
<li>What do <code>value.x</code> and <code>value.y</code> represent in this context?</li>
<li>The <code>geom_smooth()</code> function, with <code>method = lm</code>, fits a linear model. What is the significance of the <code>se</code> argument in this function?</li>
</ol>
<details closed>
<summary>
<ins>
<strong>Solution and Insights</strong>
</ins>
</summary>
<p>
<p><font color="grey"></p>
<ol style="list-style-type: decimal">
<li>The scatterplot encompasses 45 records, corresponding to half-hourly measurements over approximately 24 hours.</li>
<li>In the joined dataset, <code>value.x</code> and <code>value.y</code> represent the temperature and humidity values, respectively, after renaming to avoid duplication.</li>
<li>The se argument controls the display of confidence bounds around the regression line, which are shown by default when se is set to <code>TRUE</code>.</li>
</ol>
</font>
</p>
</details>
</div>
</div>
<div id="map-visualization" class="section level2 hasAnchor" number="10.6">
<h2><span class="header-section-number">10.6</span> Map Visualization<a href="data-viz.html#map-visualization" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In our previous exploration, we learned how to employ the <code>plot()</code> function for basic map layouts. This section, however, elevates our cartographic journey by harnessing the versatility of the <code>ggplot2</code> library for more intricate map visualizations.</p>
<p>Before diving into the examples, ensure you have the <code>sf</code> and <code>ggplot2</code> libraries installed and loaded. Additionally, download the <a href="data/nc.zip" target="_blank">North Carolina</a> and <a href="data/us-states.zip" target="_blank">US States</a> datasets for practical implementation.</p>
<p>Our first endeavor is to construct a foundational map of North Carolina:</p>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="data-viz.html#cb262-1" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb262-2"><a href="data-viz.html#cb262-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb262-3"><a href="data-viz.html#cb262-3" tabindex="-1"></a></span>
<span id="cb262-4"><a href="data-viz.html#cb262-4" tabindex="-1"></a><span class="co"># Load North Carolina shapefile</span></span>
<span id="cb262-5"><a href="data-viz.html#cb262-5" tabindex="-1"></a>nc <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_read</span>(<span class="st">&quot;data/nc.shp&quot;</span>)</span>
<span id="cb262-6"><a href="data-viz.html#cb262-6" tabindex="-1"></a></span>
<span id="cb262-7"><a href="data-viz.html#cb262-7" tabindex="-1"></a><span class="co"># Basic map of North Carolina</span></span>
<span id="cb262-8"><a href="data-viz.html#cb262-8" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> nc) <span class="sc">+</span></span>
<span id="cb262-9"><a href="data-viz.html#cb262-9" tabindex="-1"></a>  <span class="fu">geom_sf</span>() <span class="sc">+</span></span>
<span id="cb262-10"><a href="data-viz.html#cb262-10" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Longitude&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Latitude&quot;</span>) <span class="sc">+</span></span>
<span id="cb262-11"><a href="data-viz.html#cb262-11" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;North Carolina&quot;</span>, <span class="at">subtitle =</span> <span class="fu">paste0</span>(<span class="st">&quot;(&quot;</span>, <span class="fu">length</span>(<span class="fu">unique</span>(nc<span class="sc">$</span>NAME)), <span class="st">&quot; counties)&quot;</span>))</span></code></pre></div>
<p><img src="UNIGIS-AppDev-R_files/figure-html/unnamed-chunk-227-1.png" width="672" /></p>
<p>In the code above, we first load the North Carolina shapefile as an <code>sf()</code> object and then assign the data to the <code>ggplot()</code> graph. The <code>geom_sf</code> function adds a geometry stored in a <code>sf</code> object. Other map components such as title and axis labels are added by means of a plus sign. Note that <code>length(unique(nc$NAME))</code> returns the count of table rows, which corresponds to the number of geometries/counties. Geometry count and string “counties” are concatenated by function <code>paste0()</code>.</p>
<p>The geometry element <code>geom_sf</code> provides a number of arguments to customize the appearance of vector features:</p>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="data-viz.html#cb263-1" tabindex="-1"></a><span class="co"># Map with custom colors</span></span>
<span id="cb263-2"><a href="data-viz.html#cb263-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> nc) <span class="sc">+</span> </span>
<span id="cb263-3"><a href="data-viz.html#cb263-3" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;lightgreen&quot;</span>)</span></code></pre></div>
<p><img src="UNIGIS-AppDev-R_files/figure-html/unnamed-chunk-228-1.png" width="672" /></p>
<p>Data attributes can be visually represented as well. In this example, the <code>AREA</code> variable influences the fill color:</p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="data-viz.html#cb264-1" tabindex="-1"></a><span class="co"># Map with fill based on AREA</span></span>
<span id="cb264-2"><a href="data-viz.html#cb264-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> nc) <span class="sc">+</span></span>
<span id="cb264-3"><a href="data-viz.html#cb264-3" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> AREA)) <span class="sc">+</span></span>
<span id="cb264-4"><a href="data-viz.html#cb264-4" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">&quot;plasma&quot;</span>, <span class="at">trans =</span> <span class="st">&quot;sqrt&quot;</span>)</span></code></pre></div>
<p><img src="UNIGIS-AppDev-R_files/figure-html/unnamed-chunk-229-1.png" width="672" /></p>
<p>The function <code>coord_sf()</code> allows you to work with the coordinate system, which includes both the projection and extent of the map. By default, the map will use the coordinate system of the first layer or if the layer has no coordinate system, fall back on the geographic coordinate system WGS84. Using the argument <code>crs</code>, it is possible to override this setting, and project on the fly to any projection that has an <a href="https://epsg.io/" target="_blank">EPSG code</a>. For instance, we may change the coordinate system to EPSG 32618, which corresponds to WGS 84 / UTM zone 18N:</p>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="data-viz.html#cb265-1" tabindex="-1"></a><span class="co"># Map with changed coordinate system</span></span>
<span id="cb265-2"><a href="data-viz.html#cb265-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> nc) <span class="sc">+</span></span>
<span id="cb265-3"><a href="data-viz.html#cb265-3" tabindex="-1"></a>  <span class="fu">geom_sf</span>() <span class="sc">+</span></span>
<span id="cb265-4"><a href="data-viz.html#cb265-4" tabindex="-1"></a>  <span class="fu">coord_sf</span>(<span class="at">crs =</span> <span class="fu">st_crs</span>(<span class="dv">32618</span>))  <span class="co"># Projecting to WGS 84 / UTM zone 18N</span></span></code></pre></div>
<p><img src="UNIGIS-AppDev-R_files/figure-html/unnamed-chunk-230-1.png" width="672" /></p>
<p>The extent of the map can also be set in <code>coord_sf</code>, in practice allowing to “zoom” in the area of interest, provided by limits on the x-axis (<code>xlim</code>), and on the y-axis (<code>ylim</code>). The limits are automatically expanded by a fraction to ensure that data and axes do not overlap; it can also be turned off to exactly match the limits provided with <code>expand = FALSE</code>:</p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="data-viz.html#cb266-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;ggspatial&quot;</span>)</span>
<span id="cb266-2"><a href="data-viz.html#cb266-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> nc) <span class="sc">+</span></span>
<span id="cb266-3"><a href="data-viz.html#cb266-3" tabindex="-1"></a>    <span class="fu">geom_sf</span>() <span class="sc">+</span></span>
<span id="cb266-4"><a href="data-viz.html#cb266-4" tabindex="-1"></a>    <span class="fu">coord_sf</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">78.9</span>, <span class="sc">-</span><span class="fl">75.5</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">34</span>, <span class="fl">34.85</span>), <span class="at">expand =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb266-5"><a href="data-viz.html#cb266-5" tabindex="-1"></a>    <span class="fu">annotation_scale</span>(<span class="at">location =</span> <span class="st">&quot;br&quot;</span>, <span class="at">width_hint =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb266-6"><a href="data-viz.html#cb266-6" tabindex="-1"></a>    <span class="fu">annotation_north_arrow</span>(<span class="at">location =</span> <span class="st">&quot;bl&quot;</span>, <span class="at">which_north =</span> <span class="st">&quot;true&quot;</span>, </span>
<span id="cb266-7"><a href="data-viz.html#cb266-7" tabindex="-1"></a>        <span class="at">pad_x =</span> <span class="fu">unit</span>(<span class="fl">14.5</span>, <span class="st">&quot;cm&quot;</span>), <span class="at">pad_y =</span> <span class="fu">unit</span>(<span class="fl">0.8</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb266-8"><a href="data-viz.html#cb266-8" tabindex="-1"></a>        <span class="at">style =</span> north_arrow_fancy_orienteering) </span></code></pre></div>
<p><img src="UNIGIS-AppDev-R_files/figure-html/unnamed-chunk-231-1.png" width="672" /></p>
<p>Note that scale bar and north arrow are available with package <code>ggspatial</code>.</p>
<p>In the following example, we will assign labels to vector features. The function <code>geom_text()</code> can be used to add a layer of text to a map using geographic coordinates. The North Carolina dataset contains county names as column (<code>column: NAME</code>). In order to define label positions, we take the centroids of the county polygons (function <code>st_centroid()</code>), derive x and y coordinates from centroids (function <code>st_coordinates()</code>), merge the new x and y columns with the columns of <code>nc</code> and assign the output to a new variable identifier <code>nc_points</code>:</p>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="data-viz.html#cb267-1" tabindex="-1"></a>nc_points <span class="ot">&lt;-</span> <span class="fu">cbind</span>(nc, <span class="fu">st_coordinates</span>(<span class="fu">st_centroid</span>(nc<span class="sc">$</span>geometry)))</span></code></pre></div>

<div class="rmdexercise">
<p>we have used a standard syntax to create variabe <code>nc_points</code>. Convert the code to pipe operator syntax.</p>
<p>By the way, pipe operators are available with library <code>magrittr</code>, which is part of Tidyverse. So make sure to load it in your script.</p>
<details closed>
<summary>
<ins>
<strong>See solution!</strong>
</ins>
</summary>
<p>
<p><font color="grey"></p>
<p>st_centroid(nc$geometry) %&gt;%
st_coordinates() %&gt;%
cbind(nc, .)</p>
<p>Note that the reading direction of pipe syntax code is from left to right (more intuitive), whereas standard syntax (nested functions) is read from right to left.</p>
</font>
</p>
</details>
</div>
<p>After deriving centroid coordinates from <code>nc</code> geometries, we call the new variable <code>nc_points</code> in function <code>geom_text</code> and map X and Y columns (centroid coordinates) onto visual variables x and y (position in graph) and also map column <code>NAME</code> onto visual variable label. Moreover, we can insert individual text annotations manually by means of function <code>annotate()</code>:</p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="data-viz.html#cb268-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> nc) <span class="sc">+</span></span>
<span id="cb268-2"><a href="data-viz.html#cb268-2" tabindex="-1"></a><span class="fu">geom_sf</span>() <span class="sc">+</span></span>
<span id="cb268-3"><a href="data-viz.html#cb268-3" tabindex="-1"></a><span class="fu">geom_text</span>(<span class="at">data=</span> nc_points,<span class="fu">aes</span>(<span class="at">x=</span>X, <span class="at">y=</span>Y, <span class="at">label=</span>NAME),</span>
<span id="cb268-4"><a href="data-viz.html#cb268-4" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="at">fontface =</span> <span class="st">&quot;bold&quot;</span>, <span class="at">check_overlap =</span> <span class="cn">FALSE</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb268-5"><a href="data-viz.html#cb268-5" tabindex="-1"></a><span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="sc">-</span><span class="fl">76.5</span>, <span class="at">y =</span> <span class="fl">34.3</span>, <span class="at">label =</span> <span class="st">&quot;Atlantic Ocean&quot;</span>, </span>
<span id="cb268-6"><a href="data-viz.html#cb268-6" tabindex="-1"></a>    <span class="at">fontface =</span> <span class="st">&quot;italic&quot;</span>, <span class="at">color =</span> <span class="st">&quot;grey22&quot;</span>, <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb268-7"><a href="data-viz.html#cb268-7" tabindex="-1"></a><span class="fu">coord_sf</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">78.9</span>, <span class="sc">-</span><span class="fl">75.5</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">34</span>, <span class="fl">34.85</span>), <span class="at">expand =</span> <span class="cn">FALSE</span>) </span></code></pre></div>
<p><img src="UNIGIS-AppDev-R_files/figure-html/unnamed-chunk-234-1.png" width="672" /></p>
<p>In our final example, we combine previously introduced methods to craft a detailed map visualization. This example layers data sources, customizes feature appearances, and adds informative annotations:</p>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="data-viz.html#cb269-1" tabindex="-1"></a>us_states <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_read</span>(<span class="st">&quot;data/us-states.shp&quot;</span>)</span>
<span id="cb269-2"><a href="data-viz.html#cb269-2" tabindex="-1"></a>us_states_points <span class="ot">&lt;-</span> <span class="fu">st_centroid</span>(us_states)</span>
<span id="cb269-3"><a href="data-viz.html#cb269-3" tabindex="-1"></a>us_states_points <span class="ot">&lt;-</span> <span class="fu">cbind</span>(us_states, <span class="fu">st_coordinates</span>(<span class="fu">st_centroid</span>(us_states<span class="sc">$</span>geometry)))</span>
<span id="cb269-4"><a href="data-viz.html#cb269-4" tabindex="-1"></a></span>
<span id="cb269-5"><a href="data-viz.html#cb269-5" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> nc) <span class="sc">+</span></span>
<span id="cb269-6"><a href="data-viz.html#cb269-6" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> us_states, <span class="at">fill=</span> <span class="st">&quot;antiquewhite1&quot;</span>) <span class="sc">+</span></span>
<span id="cb269-7"><a href="data-viz.html#cb269-7" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> AREA)) <span class="sc">+</span></span>
<span id="cb269-8"><a href="data-viz.html#cb269-8" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data=</span> us_states_points,<span class="fu">aes</span>(<span class="at">x=</span>X, <span class="at">y=</span>Y, <span class="at">label=</span>NAME),</span>
<span id="cb269-9"><a href="data-viz.html#cb269-9" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fontface =</span> <span class="st">&quot;bold&quot;</span>, <span class="at">check_overlap =</span> <span class="cn">FALSE</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">nudge_x =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb269-10"><a href="data-viz.html#cb269-10" tabindex="-1"></a>  <span class="fu">annotation_scale</span>(<span class="at">location =</span> <span class="st">&quot;br&quot;</span>, <span class="at">width_hint =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb269-11"><a href="data-viz.html#cb269-11" tabindex="-1"></a>  <span class="fu">annotation_north_arrow</span>(<span class="at">location =</span> <span class="st">&quot;bl&quot;</span>, <span class="at">which_north =</span> <span class="st">&quot;true&quot;</span>, </span>
<span id="cb269-12"><a href="data-viz.html#cb269-12" tabindex="-1"></a>                         <span class="at">pad_x =</span> <span class="fu">unit</span>(<span class="dv">11</span>, <span class="st">&quot;cm&quot;</span>), <span class="at">pad_y =</span> <span class="fu">unit</span>(<span class="fl">0.8</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb269-13"><a href="data-viz.html#cb269-13" tabindex="-1"></a>                         <span class="at">style =</span> north_arrow_fancy_orienteering) <span class="sc">+</span> </span>
<span id="cb269-14"><a href="data-viz.html#cb269-14" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">trans =</span> <span class="st">&quot;sqrt&quot;</span>, <span class="at">alpha =</span> .<span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb269-15"><a href="data-viz.html#cb269-15" tabindex="-1"></a>  <span class="fu">coord_sf</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">84.9</span>, <span class="sc">-</span><span class="dv">70</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">24.5</span>, <span class="dv">37</span>), <span class="at">expand =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb269-16"><a href="data-viz.html#cb269-16" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Longitude&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Latitude&quot;</span>) <span class="sc">+</span></span>
<span id="cb269-17"><a href="data-viz.html#cb269-17" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;US Southeast&quot;</span>, <span class="at">subtitle =</span> <span class="st">&quot;(Detail: North Carolina)&quot;</span>) <span class="sc">+</span></span>
<span id="cb269-18"><a href="data-viz.html#cb269-18" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="sc">-</span><span class="fl">76.5</span>, <span class="at">y =</span> <span class="fl">30.5</span>, <span class="at">label =</span> <span class="st">&quot;Atlantic Ocean&quot;</span>, </span>
<span id="cb269-19"><a href="data-viz.html#cb269-19" tabindex="-1"></a>           <span class="at">fontface =</span> <span class="st">&quot;italic&quot;</span>, <span class="at">color =</span> <span class="st">&quot;grey22&quot;</span>, <span class="at">size =</span> <span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb269-20"><a href="data-viz.html#cb269-20" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="fu">gray</span>(<span class="fl">0.5</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, </span>
<span id="cb269-21"><a href="data-viz.html#cb269-21" tabindex="-1"></a>       <span class="at">size =</span> <span class="fl">0.1</span>), <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;aliceblue&quot;</span>))</span></code></pre></div>
<p><img src="UNIGIS-AppDev-R_files/figure-html/unnamed-chunk-235-1.png" width="672" /></p>
<p>Here, <code>geom_sf()</code> adds layers of US state polygons. <code>geom_label()</code> offers an alternative to <code>geom_text()</code> for feature labeling, with <code>nudge_x</code> providing horizontal label offset. The map is saved in both PDF for high-quality prints and PNG for web use. Remember to consult the <a href="https://www.rstudio.com/resources/cheatsheets/" target="_blank">ggplot2 Cheatsheet</a> for an overview of key ggplot2 operations.</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="data-viz.html#cb270-1" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;data/map.pdf&quot;</span>)</span>
<span id="cb270-2"><a href="data-viz.html#cb270-2" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;data/map_web.png&quot;</span>, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">10</span>, <span class="at">dpi =</span> <span class="st">&quot;screen&quot;</span>)</span></code></pre></div>
</div>
<div id="interactive-maps" class="section level2 hasAnchor" number="10.7">
<h2><span class="header-section-number">10.7</span> Interactive Maps<a href="data-viz.html#interactive-maps" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The <a href="https://cran.r-project.org/web/packages/leaflet/index.html" target="_blank">Leaflet library for R</a> makes it easy to create interactive web maps. Leaflet is one of the most popular open-source JavaScript libraries used by a number of websites such as <a href="https://www.nytimes.com/projects/elections/2013/nyc-primary/mayor/map.html" target="_blank">The New York Times</a>, <a href="https://www.flickr.com/map" target="_blank">Flickr</a> or <a href="https://www.openstreetmap.org/#map=14/53.7727/20.5526" target="_blank">OpenStreetMap</a>.</p>
<p>Start by initializing a Leaflet map widget and augment it with base layers and interactive markers:</p>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="data-viz.html#cb271-1" tabindex="-1"></a><span class="fu">library</span>(leaflet)</span>
<span id="cb271-2"><a href="data-viz.html#cb271-2" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">leaflet</span>() <span class="sc">%&gt;%</span></span>
<span id="cb271-3"><a href="data-viz.html#cb271-3" tabindex="-1"></a>    <span class="fu">addTiles</span>() <span class="sc">%&gt;%</span></span>
<span id="cb271-4"><a href="data-viz.html#cb271-4" tabindex="-1"></a>    <span class="fu">addMarkers</span>(<span class="at">lng=</span><span class="fl">174.768</span>, <span class="at">lat=</span><span class="sc">-</span><span class="fl">36.852</span>, <span class="at">popup=</span><span class="st">&quot;The birthplace of R&quot;</span>)</span></code></pre></div>
<p>The pipe operator (<code>%&gt;%</code>) conveniently adds layers, thanks to Leaflet’s function design.</p>

<div class="rmdtip">
The function <code>addTiles()</code> per default adds OpenStreetMap map tiles. You may use the function <code>addProviderTiles()</code> to add other map tiles. Leaflet supports a large number of <a href="http://leaflet-extras.github.io/leaflet-providers/preview/" target="_blank">basemap layers</a>.
</div>
<p>The same pipe-syntax can be used to add <a href="https://rstudio.github.io/leaflet/markers.html" target="_blank">Markers</a> and HTML <a href="https://rstudio.github.io/leaflet/popups.html" target="_blank">Labels</a> or <a href="https://rstudio.github.io/leaflet/popups.html" target="_blank">Popups</a>. In the following example, an HTML Popup locates a restaurant:</p>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="data-viz.html#cb272-1" tabindex="-1"></a><span class="fu">library</span>(leaflet)</span>
<span id="cb272-2"><a href="data-viz.html#cb272-2" tabindex="-1"></a></span>
<span id="cb272-3"><a href="data-viz.html#cb272-3" tabindex="-1"></a>content <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="at">sep =</span> <span class="st">&quot;&lt;br/&gt;&quot;</span>,</span>
<span id="cb272-4"><a href="data-viz.html#cb272-4" tabindex="-1"></a>                 <span class="st">&quot;&lt;b&gt;&lt;a href=&#39;https://www.techno-z.at/standort-und-service/gastronomie/&#39;&gt;Bistro im Techno_Z&lt;/a&gt;&lt;/b&gt;&quot;</span>,</span>
<span id="cb272-5"><a href="data-viz.html#cb272-5" tabindex="-1"></a>                 <span class="st">&quot;Schillerstrasse 30&quot;</span>,</span>
<span id="cb272-6"><a href="data-viz.html#cb272-6" tabindex="-1"></a>                 <span class="st">&quot;5020 Salzburg&quot;</span>,</span>
<span id="cb272-7"><a href="data-viz.html#cb272-7" tabindex="-1"></a>                 <span class="st">&quot;This is where I had lunch today!&quot;</span></span>
<span id="cb272-8"><a href="data-viz.html#cb272-8" tabindex="-1"></a>)</span>
<span id="cb272-9"><a href="data-viz.html#cb272-9" tabindex="-1"></a></span>
<span id="cb272-10"><a href="data-viz.html#cb272-10" tabindex="-1"></a><span class="fu">leaflet</span>() <span class="sc">%&gt;%</span></span>
<span id="cb272-11"><a href="data-viz.html#cb272-11" tabindex="-1"></a>  <span class="fu">setView</span>(<span class="at">lng =</span> <span class="fl">13.040030</span>, <span class="at">lat =</span> <span class="fl">47.823112</span>, <span class="at">zoom =</span> <span class="dv">18</span>) <span class="sc">%&gt;%</span></span>
<span id="cb272-12"><a href="data-viz.html#cb272-12" tabindex="-1"></a>  <span class="fu">addProviderTiles</span>(<span class="st">&quot;OpenStreetMap.Mapnik&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb272-13"><a href="data-viz.html#cb272-13" tabindex="-1"></a>  <span class="fu">addPopups</span>(<span class="fl">13.040030</span>, <span class="fl">47.823112</span>, content,</span>
<span id="cb272-14"><a href="data-viz.html#cb272-14" tabindex="-1"></a>            <span class="at">options =</span> <span class="fu">popupOptions</span>(<span class="at">closeButton =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<div class="leaflet html-widget html-fill-item" id="htmlwidget-ed9b7b263ca34d9e4d7d" style="width:672px;height:384px;"></div>
<script type="application/json" data-for="htmlwidget-ed9b7b263ca34d9e4d7d">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"setView":[[47.823112,13.04003],18,[]],"calls":[{"method":"addProviderTiles","args":["OpenStreetMap.Mapnik",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addPopups","args":[47.823112,13.04003,"<b><a href='https://www.techno-z.at/standort-und-service/gastronomie/'>Bistro im Techno_Z<\/a><\/b><br/>Schillerstrasse 30<br/>5020 Salzburg<br/>This is where I had lunch today!",null,null,{"maxWidth":300,"minWidth":50,"autoPan":true,"keepInView":false,"closeButton":true,"className":""}]}],"limits":{"lat":[47.823112,47.823112],"lng":[13.04003,13.04003]}},"evals":[],"jsHooks":[]}</script>
<p>Moreover, Leaflet offers numerous methods and functions for <a href="https://rstudio.github.io/leaflet/map_widget.html" target="_blank">manipulating the map widget</a> and integrating <a href="https://rstudio.github.io/leaflet/shapes.html" target="_blank">lines and shapes</a>, <a href="https://rstudio.github.io/leaflet/json.html" target="_blank">GeoJSON</a> and <a href="https://rstudio.github.io/leaflet/raster.html" target="_blank">Raster Images</a>. To get more information on creating interactive maps with R and Leaflet, turn to the <a href="https://rstudio.github.io/leaflet/" target="_blank">Documentation</a>.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="spm.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="r-markdown.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
