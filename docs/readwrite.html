<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Lesson 8 Read and Write Data | Automated Data Processing with R</title>
  <meta name="description" content="BookDown materials for the UNIGIS module Application Development - Introduction to R." />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="Lesson 8 Read and Write Data | Automated Data Processing with R" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/branding/Cover_epub.png" />
  <meta property="og:description" content="BookDown materials for the UNIGIS module Application Development - Introduction to R." />
  <meta name="github-repo" content="UNIGIS-Salzburg/En_AppDev-R" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Lesson 8 Read and Write Data | Automated Data Processing with R" />
  
  <meta name="twitter:description" content="BookDown materials for the UNIGIS module Application Development - Introduction to R." />
  <meta name="twitter:image" content="/branding/Cover_epub.png" />

<meta name="author" content="Christian Neuwirth &amp; Maximilian Elixhauser" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="branding/unigis_globe_gruen_transparent.png" type="image/x-icon" />
<link rel="prev" href="datman.html"/>
<link rel="next" href="spm.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.2.2/leaflet.js"></script>
<script src="libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.2.2/leaflet-providers-plugin.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="css/custom.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://unigis.at/en" target="_blank"><img alt="UNIGIS Salzburg" src="branding/UNIGIS_Salzburg_Schriftlogo_v05.png" width=100%></a></li>
<li><a href="./">Automated Data Processing with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction to R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#about-this-module"><i class="fa fa-check"></i><b>1.1</b> About this module</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#r-programming-language"><i class="fa fa-check"></i><b>1.2</b> R programming language</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#installation-and-setup"><i class="fa fa-check"></i><b>1.3</b> Installation and Setup</a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#interpreting-values"><i class="fa fa-check"></i><b>1.4</b> Interpreting Values</a></li>
<li class="chapter" data-level="1.5" data-path="intro.html"><a href="intro.html#simple-data-types"><i class="fa fa-check"></i><b>1.5</b> Simple Data Types</a></li>
<li class="chapter" data-level="1.6" data-path="intro.html"><a href="intro.html#numop"><i class="fa fa-check"></i><b>1.6</b> Numeric operators</a></li>
<li class="chapter" data-level="1.7" data-path="intro.html"><a href="intro.html#logical-operators"><i class="fa fa-check"></i><b>1.7</b> Logical operators</a></li>
<li class="chapter" data-level="1.8" data-path="intro.html"><a href="intro.html#references"><i class="fa fa-check"></i><b>1.8</b> References</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="core.html"><a href="core.html"><i class="fa fa-check"></i><b>2</b> Core Concepts</a>
<ul>
<li class="chapter" data-level="2.1" data-path="core.html"><a href="core.html#variables"><i class="fa fa-check"></i><b>2.1</b> Variables</a></li>
<li class="chapter" data-level="2.2" data-path="core.html"><a href="core.html#algorithms-and-functions"><i class="fa fa-check"></i><b>2.2</b> Algorithms and Functions</a></li>
<li class="chapter" data-level="2.3" data-path="core.html"><a href="core.html#libraries"><i class="fa fa-check"></i><b>2.3</b> Libraries</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="DS.html"><a href="DS.html"><i class="fa fa-check"></i><b>3</b> Data Structures</a>
<ul>
<li class="chapter" data-level="3.1" data-path="DS.html"><a href="DS.html#vectors"><i class="fa fa-check"></i><b>3.1</b> Vectors</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="DS.html"><a href="DS.html#vector-element-selection"><i class="fa fa-check"></i><b>3.1.1</b> Vector Element Selection</a></li>
<li class="chapter" data-level="3.1.2" data-path="DS.html"><a href="DS.html#using-the-range-function-with-vectors"><i class="fa fa-check"></i><b>3.1.2</b> Using the range() Function with Vectors</a></li>
<li class="chapter" data-level="3.1.3" data-path="DS.html"><a href="DS.html#applying-functions-to-vectors"><i class="fa fa-check"></i><b>3.1.3</b> Applying Functions to Vectors</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="DS.html"><a href="DS.html#multi-dimensional-data-types"><i class="fa fa-check"></i><b>3.2</b> Multi-dimensional Data Types</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="DS.html"><a href="DS.html#matrices"><i class="fa fa-check"></i><b>3.2.1</b> Matrices</a></li>
<li class="chapter" data-level="3.2.2" data-path="DS.html"><a href="DS.html#arrays"><i class="fa fa-check"></i><b>3.2.2</b> Arrays</a></li>
<li class="chapter" data-level="3.2.3" data-path="DS.html"><a href="DS.html#selection-in-multi-dimensional-data-types"><i class="fa fa-check"></i><b>3.2.3</b> Selection in Multi-Dimensional Data Types</a></li>
<li class="chapter" data-level="3.2.4" data-path="DS.html"><a href="DS.html#lists"><i class="fa fa-check"></i><b>3.2.4</b> Lists</a></li>
<li class="chapter" data-level="3.2.5" data-path="DS.html"><a href="DS.html#data-frame"><i class="fa fa-check"></i><b>3.2.5</b> Data Frame</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="spds.html"><a href="spds.html"><i class="fa fa-check"></i><b>4</b> Spatial Data Structures</a>
<ul>
<li class="chapter" data-level="4.1" data-path="spds.html"><a href="spds.html#vector-data-structures"><i class="fa fa-check"></i><b>4.1</b> Vector Data Structures</a></li>
<li class="chapter" data-level="4.2" data-path="spds.html"><a href="spds.html#raster-data-structures"><i class="fa fa-check"></i><b>4.2</b> Raster Data Structures</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="spds.html"><a href="spds.html#working-with-spatraster-objects"><i class="fa fa-check"></i><b>4.2.1</b> Working with SpatRaster objects</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="control-structures.html"><a href="control-structures.html"><i class="fa fa-check"></i><b>5</b> Control Structures</a>
<ul>
<li class="chapter" data-level="5.1" data-path="control-structures.html"><a href="control-structures.html#if"><i class="fa fa-check"></i><b>5.1</b> If</a></li>
<li class="chapter" data-level="5.2" data-path="control-structures.html"><a href="control-structures.html#else"><i class="fa fa-check"></i><b>5.2</b> Else</a></li>
<li class="chapter" data-level="5.3" data-path="control-structures.html"><a href="control-structures.html#code-blocks"><i class="fa fa-check"></i><b>5.3</b> Code blocks</a></li>
<li class="chapter" data-level="5.4" data-path="control-structures.html"><a href="control-structures.html#loops"><i class="fa fa-check"></i><b>5.4</b> Loops</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="control-structures.html"><a href="control-structures.html#while-and-repeat"><i class="fa fa-check"></i><b>5.4.1</b> While and repeat</a></li>
<li class="chapter" data-level="5.4.2" data-path="control-structures.html"><a href="control-structures.html#for"><i class="fa fa-check"></i><b>5.4.2</b> For</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="control-structures.html"><a href="control-structures.html#loops-with-conditional-statements"><i class="fa fa-check"></i><b>5.5</b> Loops with conditional statements</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="control-structures.html"><a href="control-structures.html#exercise-loops-with-conditional-statements"><i class="fa fa-check"></i><b>5.5.1</b> Exercise: loops with conditional statements</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>6</b> Functions</a>
<ul>
<li class="chapter" data-level="6.1" data-path="functions.html"><a href="functions.html#defining-functions"><i class="fa fa-check"></i><b>6.1</b> Defining Functions</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="functions.html"><a href="functions.html#understanding-the-return-function"><i class="fa fa-check"></i><b>6.1.1</b> Understanding the <code>return()</code> Function</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="functions.html"><a href="functions.html#more-parameters"><i class="fa fa-check"></i><b>6.2</b> More Parameters</a></li>
<li class="chapter" data-level="6.3" data-path="functions.html"><a href="functions.html#returning-multiple-values"><i class="fa fa-check"></i><b>6.3</b> Returning Multiple Values</a></li>
<li class="chapter" data-level="6.4" data-path="functions.html"><a href="functions.html#functions-and-control-structures"><i class="fa fa-check"></i><b>6.4</b> Functions and Control Structures</a></li>
<li class="chapter" data-level="6.5" data-path="functions.html"><a href="functions.html#scope"><i class="fa fa-check"></i><b>6.5</b> Scope</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="datman.html"><a href="datman.html"><i class="fa fa-check"></i><b>7</b> Data Manipulation</a>
<ul>
<li class="chapter" data-level="7.1" data-path="datman.html"><a href="datman.html#preparation"><i class="fa fa-check"></i><b>7.1</b> Preparation</a></li>
<li class="chapter" data-level="7.2" data-path="datman.html"><a href="datman.html#data-manipulation"><i class="fa fa-check"></i><b>7.2</b> Data manipulation</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="datman.html"><a href="datman.html#summarise"><i class="fa fa-check"></i><b>7.2.1</b> Summarise</a></li>
<li class="chapter" data-level="7.2.2" data-path="datman.html"><a href="datman.html#select-and-filter"><i class="fa fa-check"></i><b>7.2.2</b> Select and filter</a></li>
<li class="chapter" data-level="7.2.3" data-path="datman.html"><a href="datman.html#mutate"><i class="fa fa-check"></i><b>7.2.3</b> Mutate</a></li>
<li class="chapter" data-level="7.2.4" data-path="datman.html"><a href="datman.html#arrange"><i class="fa fa-check"></i><b>7.2.4</b> Arrange</a></li>
<li class="chapter" data-level="7.2.5" data-path="datman.html"><a href="datman.html#exercise-data-manipulation"><i class="fa fa-check"></i><b>7.2.5</b> Exercise: data manipulation</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="datman.html"><a href="datman.html#join"><i class="fa fa-check"></i><b>7.3</b> Join</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="datman.html"><a href="datman.html#exercise-join"><i class="fa fa-check"></i><b>7.3.1</b> Exercise: join</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="readwrite.html"><a href="readwrite.html"><i class="fa fa-check"></i><b>8</b> Read and Write Data</a>
<ul>
<li class="chapter" data-level="8.1" data-path="readwrite.html"><a href="readwrite.html#read-and-write-tabular-data"><i class="fa fa-check"></i><b>8.1</b> Read and write tabular data</a></li>
<li class="chapter" data-level="8.2" data-path="readwrite.html"><a href="readwrite.html#read-and-write-vector-data"><i class="fa fa-check"></i><b>8.2</b> Read and write vector data</a></li>
<li class="chapter" data-level="8.3" data-path="readwrite.html"><a href="readwrite.html#read-and-write-raster-data"><i class="fa fa-check"></i><b>8.3</b> Read and write raster data</a></li>
<li class="chapter" data-level="8.4" data-path="readwrite.html"><a href="readwrite.html#data-api"><i class="fa fa-check"></i><b>8.4</b> Data API</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="spm.html"><a href="spm.html"><i class="fa fa-check"></i><b>9</b> Spatial Data Manipulation</a>
<ul>
<li class="chapter" data-level="9.1" data-path="spm.html"><a href="spm.html#data-acquisition"><i class="fa fa-check"></i><b>9.1</b> Data Acquisition</a></li>
<li class="chapter" data-level="9.2" data-path="spm.html"><a href="spm.html#data-cleaning"><i class="fa fa-check"></i><b>9.2</b> Data Cleaning</a></li>
<li class="chapter" data-level="9.3" data-path="spm.html"><a href="spm.html#vector-operations"><i class="fa fa-check"></i><b>9.3</b> Vector operations</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="spm.html"><a href="spm.html#geometrical-operations"><i class="fa fa-check"></i><b>9.3.1</b> Geometrical operations</a></li>
<li class="chapter" data-level="9.3.2" data-path="spm.html"><a href="spm.html#binary-operations"><i class="fa fa-check"></i><b>9.3.2</b> Binary operations</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="spm.html"><a href="spm.html#raster-operations"><i class="fa fa-check"></i><b>9.4</b> Raster operations</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="spm.html"><a href="spm.html#resampling"><i class="fa fa-check"></i><b>9.4.1</b> Resampling</a></li>
<li class="chapter" data-level="9.4.2" data-path="spm.html"><a href="spm.html#crop-raster"><i class="fa fa-check"></i><b>9.4.2</b> Crop raster</a></li>
<li class="chapter" data-level="9.4.3" data-path="spm.html"><a href="spm.html#raster-algebra"><i class="fa fa-check"></i><b>9.4.3</b> Raster algebra</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="data-viz.html"><a href="data-viz.html"><i class="fa fa-check"></i><b>10</b> Data Visualization</a>
<ul>
<li class="chapter" data-level="10.1" data-path="data-viz.html"><a href="data-viz.html#the-grammar-of-graphics"><i class="fa fa-check"></i><b>10.1</b> The Grammar of Graphics</a></li>
<li class="chapter" data-level="10.2" data-path="data-viz.html"><a href="data-viz.html#understanding-wide-and-long-data-formats-in-r"><i class="fa fa-check"></i><b>10.2</b> Understanding Wide and Long Data Formats in R</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="data-viz.html"><a href="data-viz.html#wide-format"><i class="fa fa-check"></i><b>10.2.1</b> Wide format</a></li>
<li class="chapter" data-level="10.2.2" data-path="data-viz.html"><a href="data-viz.html#long-format"><i class="fa fa-check"></i><b>10.2.2</b> Long format:</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="data-viz.html"><a href="data-viz.html#visualization-of-distributions"><i class="fa fa-check"></i><b>10.3</b> Visualization of distributions</a></li>
<li class="chapter" data-level="10.4" data-path="data-viz.html"><a href="data-viz.html#boxplots"><i class="fa fa-check"></i><b>10.4</b> Boxplots</a></li>
<li class="chapter" data-level="10.5" data-path="data-viz.html"><a href="data-viz.html#scatterplots"><i class="fa fa-check"></i><b>10.5</b> Scatterplots</a></li>
<li class="chapter" data-level="10.6" data-path="data-viz.html"><a href="data-viz.html#map-visualization"><i class="fa fa-check"></i><b>10.6</b> Map Visualization</a></li>
<li class="chapter" data-level="10.7" data-path="data-viz.html"><a href="data-viz.html#interactive-maps"><i class="fa fa-check"></i><b>10.7</b> Interactive Maps</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="r-markdown.html"><a href="r-markdown.html"><i class="fa fa-check"></i><b>11</b> R Markdown</a>
<ul>
<li class="chapter" data-level="11.1" data-path="r-markdown.html"><a href="r-markdown.html#set-up-your-work-environment"><i class="fa fa-check"></i><b>11.1</b> Set up your work environment</a></li>
<li class="chapter" data-level="11.2" data-path="r-markdown.html"><a href="r-markdown.html#create-a-local-clone"><i class="fa fa-check"></i><b>11.2</b> Create a local clone</a></li>
<li class="chapter" data-level="11.3" data-path="r-markdown.html"><a href="r-markdown.html#creating-your-first-r-markdown-document"><i class="fa fa-check"></i><b>11.3</b> Creating Your First R Markdown Document</a></li>
<li class="chapter" data-level="11.4" data-path="r-markdown.html"><a href="r-markdown.html#synchronizing-with-github"><i class="fa fa-check"></i><b>11.4</b> Synchronizing with GitHub</a></li>
<li class="chapter" data-level="11.5" data-path="r-markdown.html"><a href="r-markdown.html#basic-r-markdown-syntax"><i class="fa fa-check"></i><b>11.5</b> Basic R Markdown Syntax</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="r-markdown.html"><a href="r-markdown.html#references-in-rmarkdown"><i class="fa fa-check"></i><b>11.5.1</b> References in RMarkdown</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="r-markdown.html"><a href="r-markdown.html#speed-up-your-workflows"><i class="fa fa-check"></i><b>11.6</b> Speed up your workflows</a></li>
<li class="chapter" data-level="11.7" data-path="r-markdown.html"><a href="r-markdown.html#self-study"><i class="fa fa-check"></i><b>11.7</b> Self-study</a></li>
</ul></li>
<li class="divider"></li>
<li>Copyright © UNIGIS Salzburg.</li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Automated Data Processing with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="readwrite" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">Lesson 8</span> Read and Write Data<a href="readwrite.html#readwrite" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In previous exercises we have <strong>read</strong> data from a CSV file into our script. Similarly we can also <strong>write</strong> code outputs to file.</p>

<div class="rmdtip">
<p>In this lesson you will learn to read and write plain-text, spatial vector and raster file formats. Moreover, we will retrieve online data by means of a data API.</p>
</div>
<div id="read-and-write-tabular-data" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> Read and write tabular data<a href="readwrite.html#read-and-write-tabular-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A series of formats are based on plain-text files.</p>
<p>For instance…</p>
<ul>
<li>comma-separated values files <code>.csv</code></li>
<li>semi-colon-separated values files <code>.csv</code></li>
<li>tab-separated values files <code>.tsv</code></li>
<li>other formats using custom delimiters</li>
<li>fix-width files <code>.fwf</code></li>
</ul>
<p>The <a href="https://readr.tidyverse.org/" target="_blank"><code>readr</code> library</a> (also part of <a href="https://www.tidyverse.org/packages/#import" target="_blank">Tidyverse</a>) provides a series of functions that can be used to load from and save to such data formats. For instance, the <code>read_csv</code> function reads a comma-delimited CSV file from the path provided as the first argument.</p>
<p>The code example below reads a CSV file that contains global fishery statistics provided by the <a href="https://datacatalog.worldbank.org/dataset/world-development-indicators" target="_blank">World Bank</a> and queries Norwegian entries. The function <code>write_csv</code> writes these entries to a new CSV file.</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="readwrite.html#cb196-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb196-2"><a href="readwrite.html#cb196-2" tabindex="-1"></a></span>
<span id="cb196-3"><a href="readwrite.html#cb196-3" tabindex="-1"></a>fishery_data <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">&quot;data/capture-fisheries-vs-aquaculture.csv&quot;</span>)</span>
<span id="cb196-4"><a href="readwrite.html#cb196-4" tabindex="-1"></a><span class="co"># print(fishery_data)</span></span>
<span id="cb196-5"><a href="readwrite.html#cb196-5" tabindex="-1"></a></span>
<span id="cb196-6"><a href="readwrite.html#cb196-6" tabindex="-1"></a><span class="co"># print(typeof(fishery_data$))</span></span>
<span id="cb196-7"><a href="readwrite.html#cb196-7" tabindex="-1"></a></span>
<span id="cb196-8"><a href="readwrite.html#cb196-8" tabindex="-1"></a>fishery_data <span class="sc">%&gt;%</span></span>
<span id="cb196-9"><a href="readwrite.html#cb196-9" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Entity <span class="sc">==</span> <span class="st">&quot;Norway&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb196-10"><a href="readwrite.html#cb196-10" tabindex="-1"></a>  readr<span class="sc">::</span><span class="fu">write_csv</span>(<span class="st">&quot;data/capture-fisheries-vs-aquaculture-norway.csv&quot;</span>, <span class="at">append=</span><span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb196-11"><a href="readwrite.html#cb196-11" tabindex="-1"></a>  </span>
<span id="cb196-12"><a href="readwrite.html#cb196-12" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb196-13"><a href="readwrite.html#cb196-13" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code></pre></div>
<table>
<colgroup>
<col width="7%" />
<col width="5%" />
<col width="5%" />
<col width="38%" />
<col width="44%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Entity</th>
<th align="left">Code</th>
<th align="right">Year</th>
<th align="right">Aquaculture production (metric tons)</th>
<th align="right">Capture fisheries production (metric tons)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Norway</td>
<td align="left">NOR</td>
<td align="right">1960</td>
<td align="right">1900</td>
<td align="right">1609362</td>
</tr>
<tr class="even">
<td align="left">Norway</td>
<td align="left">NOR</td>
<td align="right">1961</td>
<td align="right">900</td>
<td align="right">1758413</td>
</tr>
<tr class="odd">
<td align="left">Norway</td>
<td align="left">NOR</td>
<td align="right">1962</td>
<td align="right">200</td>
<td align="right">1572913</td>
</tr>
</tbody>
</table>
<p>In order to run the script, <a href="data/capture-fisheries-vs-aquaculture.csv" target="_blank">download the CSV file</a>. Then copy and run the code in a new R-script.</p>

<div class="rmdtip">
Other important packages for reading tabular data are <a href="https://readxl.tidyverse.org/" target="_blank"><code>readxl</code></a> for Excel (<code>.xls</code> and <code>.xlsx</code>) and <a href="https://haven.tidyverse.org/" target="_blank"><code>haven</code></a> for SPSS, Stata and SAS data.
</div>
</div>
<div id="read-and-write-vector-data" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> Read and write vector data<a href="readwrite.html#read-and-write-vector-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The library <code>sf</code> makes it easy to read and write vector datasets such as shapefiles.</p>

<div class="rmdtip">
Remember: In lesson <a href="spds.html#spds">4</a>, we used the <code>sf</code> library to build vector geometries from scratch. Investigate their properties and assign and transform coordinate reference systems. The name sf stands for <strong>simple features</strong>, meaning that <a href="https://r-spatial.github.io/sf/articles/sf1.html" target="_blank">sf-objects conform to the simple feature standard</a>. Now we use the same library to load sf-objects from file.
</div>
<p>In order to load vector data in an R-Script, we can use the function <code>st_read()</code>. In the code block below, a <a href="data/nc.zip" target="_blank">shapefile</a> (<a href="https://r-spatial.github.io/sf/reference/nc.html" target="_blank">North Carolina sample data</a>) is loaded and assigned to a variable <code>nc</code>.</p>
<p>The next line creates a basic map in <code>sf</code> by means of <code>plot()</code>. By default this creates a multi-panel plot, one sub-plot for each variable (attribute) of the sf-object.</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="readwrite.html#cb197-1" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb197-2"><a href="readwrite.html#cb197-2" tabindex="-1"></a></span>
<span id="cb197-3"><a href="readwrite.html#cb197-3" tabindex="-1"></a>nc <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_read</span>(<span class="st">&quot;data/nc.shp&quot;</span>)</span>
<span id="cb197-4"><a href="readwrite.html#cb197-4" tabindex="-1"></a></span>
<span id="cb197-5"><a href="readwrite.html#cb197-5" tabindex="-1"></a><span class="fu">plot</span>(nc)</span></code></pre></div>
<p><img src="UNIGIS-AppDev-R_files/figure-html/unnamed-chunk-165-1.png" width="672" /></p>
<p>As you have learned in lesson <a href="spds.html#spds">4</a>, <code>sf</code> represents features as records in data-frame-like structures with an additional <code>geometry</code> list-column. The example below renders three features (rows) of variable <code>nc</code> including the <code>geometry</code> column of type <code>MULTIPOLYGON</code> (see <a href="https://r-spatial.github.io/sf/articles/sf1.html#simple-feature-geometry-types" target="_blank">Simple feature geometry types</a>) as well as the attributes <code>AREA</code> (feature area) and <code>NAME</code> (name of county):</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="readwrite.html#cb198-1" tabindex="-1"></a>nc <span class="sc">%&gt;%</span></span>
<span id="cb198-2"><a href="readwrite.html#cb198-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(AREA, NAME, geometry) <span class="sc">%&gt;%</span></span>
<span id="cb198-3"><a href="readwrite.html#cb198-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb198-4"><a href="readwrite.html#cb198-4" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">AREA</th>
<th align="left">NAME</th>
<th align="left">geometry</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.114</td>
<td align="left">Ashe</td>
<td align="left">MULTIPOLYGON (((-81.47276 3…</td>
</tr>
<tr class="even">
<td align="right">0.061</td>
<td align="left">Alleghany</td>
<td align="left">MULTIPOLYGON (((-81.23989 3…</td>
</tr>
<tr class="odd">
<td align="right">0.143</td>
<td align="left">Surry</td>
<td align="left">MULTIPOLYGON (((-80.45634 3…</td>
</tr>
</tbody>
</table>
<p><code>sf</code> also includes a number of operations to manipulate the geometry of features such as <code>st_simplify</code>:</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="readwrite.html#cb199-1" tabindex="-1"></a>sf<span class="sc">::</span><span class="fu">st_simplify</span>(nc) <span class="sc">%&gt;%</span></span>
<span id="cb199-2"><a href="readwrite.html#cb199-2" tabindex="-1"></a>  <span class="fu">plot</span>(., <span class="at">max.plot =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="UNIGIS-AppDev-R_files/figure-html/unnamed-chunk-167-1.png" width="672" /></p>

<div class="rmdtip">
<p>You may have recognized that a dot (<code>.</code>) is used as a parameter in the function <code>plot()</code>. The dot represents the piped value. In the example above the dot is used to define the simplified geometry of <code>nc</code> as first parameter of function <code>plot()</code> and <code>max.plot = 1</code> as the second.</p>
</div>
<p>In the next example, the <code>st_geometry()</code> retrieves the geometry attribute from variable <code>nc</code>, function <code>st_centroid()</code> calculates the centroid of the polygon geometry (<code>counties</code>) and function <code>st_write</code> writes the centroid point geometry to file.</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="readwrite.html#cb200-1" tabindex="-1"></a>sf<span class="sc">::</span><span class="fu">st_geometry</span>(nc) <span class="sc">%&gt;%</span></span>
<span id="cb200-2"><a href="readwrite.html#cb200-2" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_centroid</span>() <span class="sc">%&gt;%</span></span>
<span id="cb200-3"><a href="readwrite.html#cb200-3" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_write</span>(<span class="st">&quot;data/nc-centroids.shp&quot;</span>, <span class="at">delete_dsn =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb200-4"><a href="readwrite.html#cb200-4" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">pch =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="st">&#39;red&#39;</span>) </span></code></pre></div>
<p><img src="UNIGIS-AppDev-R_files/figure-html/unnamed-chunk-169-1.png" width="672" /></p>

<div class="rmdtip">
The online book <a href="https://r.geocompx.org/" target="_blank">Geocomputation with R</a> offers a more comprehensive explanation of available geometric, attribute and spatial data operations. For a quick overview, you may turn to the <a href="https://github.com/rstudio/cheatsheets/blob/master/sf.pdf" target="_blank">sf cheatsheets</a>.
</div>
<p>In order to test the code on your machine, <a href="data/nc-centroids.zip" target="_blank">download</a> the North Carolina dataset and install the libraries <code>sf</code> and <code>Rcpp</code> before you run the code in an R-Script.</p>

<div class="rmdexercise">
<p>The <code>plot()</code> function offers a large number of arguments that can be used to customize your map. Replace ‘AREA’ in the map above by a more meaningful map title. Turn to the <a href="https://r-spatial.github.io/sf/reference/plot.html" target="_blank">documentation</a> for more information.</p>
<p>See <a href="Solution_Miniexercise_plot.R" target="_blank">our solution</a>!</p>
</div>
</div>
<div id="read-and-write-raster-data" class="section level2 hasAnchor" number="8.3">
<h2><span class="header-section-number">8.3</span> Read and write raster data<a href="readwrite.html#read-and-write-raster-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The <code>terra</code> library provides functions to read and write raster data. In lesson <a href="spds.html#spds">4</a>, we used the <code>terra</code> library to build <code>SpatRaster Objects</code> from scratch, investigated their properties and assigned and transformed coordinate reference systems.</p>
<p>It is more common, however, to create a <code>SpatRaster Object</code> from a file. Supported file formats for reading are GeoTIFF, ESRI, ENVI, and ERDAS. Most formats supported for reading can also be written to (see <a href="https://rspatial.org/pkg/3-objects.html" target="_blank">Creating <code>SpatRaster objects</code></a>).</p>
<p>The following code reads a GeoTIFF (download <a href="data/venice-Sentinel.tiff" target="_blank">venice-Sentinel.tiff 712KB</a>) into memory and assigns it to a variable named <code>r</code>:</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="readwrite.html#cb201-1" tabindex="-1"></a><span class="fu">library</span>(terra)</span>
<span id="cb201-2"><a href="readwrite.html#cb201-2" tabindex="-1"></a></span>
<span id="cb201-3"><a href="readwrite.html#cb201-3" tabindex="-1"></a>r <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">rast</span>(<span class="st">&quot;data/venice-Sentinel.tiff&quot;</span>)</span></code></pre></div>
<p>The function <code>hasValues</code> returns the logic value <code>TRUE</code>, which indicates that in-memory layers have cell values:</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="readwrite.html#cb202-1" tabindex="-1"></a>terra<span class="sc">::</span><span class="fu">hasValues</span>(r)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>Executing the variable name <code>r</code> returns additional metadata information, which among others reveals that the image has 4 layers:</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="readwrite.html#cb204-1" tabindex="-1"></a>r</span></code></pre></div>
<pre><code>## class       : SpatRaster 
## dimensions  : 503, 692, 4  (nrow, ncol, nlyr)
## resolution  : 7.025638, 6.675899  (x, y)
## extent      : 288674.2, 293535.9, 5033073, 5036431  (xmin, xmax, ymin, ymax)
## coord. ref. : WGS 84 / UTM zone 33N (EPSG:32633) 
## source      : venice-Sentinel.tiff 
## names       : venice-Sentinel_1, venice-Sentinel_2, venice-Sentinel_3, venice-Sentinel_4</code></pre>
<p>Layers 1-3 correspond to color bands red, green, and blue. In order to plot the true color sentinel imagery, we can use <code>terra</code> function <code>plotRGB</code> and assign the numbers of respective color bands to attributes <code>r</code> (red), <code>g</code> (greeb), <code>b</code> (blue):</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="readwrite.html#cb206-1" tabindex="-1"></a>terra<span class="sc">::</span><span class="fu">plotRGB</span>(r, <span class="at">r=</span><span class="dv">1</span>, <span class="at">g=</span><span class="dv">2</span>, <span class="at">b=</span><span class="dv">3</span>, <span class="at">main=</span><span class="st">&quot;Sentinel-2 image of Venice&quot;</span>)</span></code></pre></div>
<p><img src="UNIGIS-AppDev-R_files/figure-html/unnamed-chunk-175-1.png" width="672" /></p>
<p>The following line converts the original CRS (which is WGS 84 / UTM zone 33N) to the Italian national CRS <a href="https://spatialreference.org/ref/epsg/3003/" target="_blank">Italy Zone 1:</a></p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="readwrite.html#cb207-1" tabindex="-1"></a>r_z1 <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">project</span>(r, <span class="st">&quot;+proj=tmerc +lat_0=0 +lon_0=9 +k=0.9996 +x_0=1500000 +y_0=0 +ellps=intl +units=m +no_defs&quot;</span>)</span></code></pre></div>
<p>Eventually, the modified <code>SpatRaster Object</code> is written to file by means of <code>terra</code> function <code>writeRaster</code>:</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="readwrite.html#cb208-1" tabindex="-1"></a>terra<span class="sc">::</span><span class="fu">writeRaster</span>(r_z1, <span class="st">&quot;data/venice_zone1.tif&quot;</span>, <span class="at">overwrite=</span><span class="cn">TRUE</span>)</span></code></pre></div>
</div>
<div id="data-api" class="section level2 hasAnchor" number="8.4">
<h2><span class="header-section-number">8.4</span> Data API<a href="readwrite.html#data-api" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<blockquote>
<p>API is the acronym for Application Programming Interface, which is a software intermediary that allows two applications to talk to each other.</p>
</blockquote>
<p>By means of an API we can read, write, and modify information on the web. The following video briefly introduces the technology behind it.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:APIvideo"></span>
<iframe src="https://www.youtube.com/embed/7YcW25PHnAA?end=194" width="672" height="400px" data-external="1">
</iframe>
<p class="caption">
Figure 8.1: Video (3:13 min): REST API concepts and examples.
</p>
</div>
<p>The most important takeaway messages are:</p>
<ol style="list-style-type: decimal">
<li>With a REST API, web data is accessible through a URL (Client-Server call via HTTP protocol)</li>
<li>The HTTP <strong>Get</strong> Method delivers data (a Response) - i.e. is used to read data, the HTTP <strong>Post</strong> Method is used to create new REST API resources (write data).</li>
<li>URL Parameters are used to filter specific data from a response.</li>
<li>Typically, APIs can return data in a number of different formats.</li>
<li>JSON is a very popular format for transferring web data.</li>
<li>The two primary elements that make up JSON are keys and values.</li>
</ol>
<p>The library <a href="https://httr2.r-lib.org/" target="_blank">httr2</a> offers functions to programmatically implement API calls in an R script. We will make use of this library to let our R script interact with the <a href="https://openweathermap.org/api" target="_blank">APIs</a> offered by <a href="https://openweathermap.org/" target="_blank">OpenWeather Map</a> that contains historical and real-time weather data for retrieval. In the upcoming example we will make a call to the <a href="https://openweathermap.org/current" target="_blank">Current Weather API</a>, which is one out of currently <a href="https://openweathermap.org/price" target="_blank">10 free APIs</a> provided by OpenWeather Map.</p>
<p>For accessing the data with <code>httr2</code>, we’ll construct a URL composed of a reference to the data source (<code>base</code>), an API key to get access, and parameters to filter the desired data subset (<code>lat</code> and <code>lon</code>).</p>

<div class="rmdtip">
<p>Note: The OpenWeather API requires an API Key to be passed as a parameter in the call. Get your <a href="https://openweathermap.org/appid" target="_blank">personal Key</a> to implement your own API requests.</p>
<p>If your code returns an error 401, this most likely indicates that your key is not activated yet. According to the <a href="https://openweathermap.org/faq" target="_blank">FAQs</a>, it may take a couple of hours until your key is active.</p>
</div>

<div class="rmdtip">
<strong>Security Note:</strong>
In general, when working with APIs, it’s crucial to handle API keys securely. API keys are sensitive tokens that authenticate your requests to an API service. Exposing these keys publicly can lead to unauthorized access and potential misuse. Always keep your API keys confidential. Avoid hardcoding them directly into scripts, especially if the scripts are shared or stored in public repositories. Instead, consider using environment variables or secure vaults to store your API keys. For sharing scripts, you can instruct users to enter their own keys, ensuring that each user’s key remains private.
</div>
<p>First we will have to create an URL request. The function <code>sprintf()</code> assembles the URL request composed of <code>base URL</code>, <code>key</code> and <code>lat / lon</code>:</p>

<div class="rmdtip">
<strong>Note</strong>:
The <code>sprintf()</code> function in R is used for string formatting. It allows you to combine, format, and interpolate variables into strings in a flexible way. For example, <code>sprintf("%s?lat=%s&amp;lon=%s&amp;appid=%s", base, lat, lon, apiKey)</code> constructs a URL string by inserting the values of <code>base</code>, <code>lat</code>, <code>lon</code>, and <code>apiKey</code> into the placeholders (<code>%s</code>). Each <code>%s</code> is replaced by the corresponding variable’s value in the order they are listed. This function is particularly useful in scenarios where you need to dynamically generate strings or URLs with variable data.
</div>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="readwrite.html#cb209-1" tabindex="-1"></a><span class="fu">library</span>(httr2)</span>
<span id="cb209-2"><a href="readwrite.html#cb209-2" tabindex="-1"></a></span>
<span id="cb209-3"><a href="readwrite.html#cb209-3" tabindex="-1"></a><span class="co"># Define the base URL and parameters</span></span>
<span id="cb209-4"><a href="readwrite.html#cb209-4" tabindex="-1"></a>base <span class="ot">&lt;-</span> <span class="st">&quot;http://api.openweathermap.org/data/2.5/weather&quot;</span></span>
<span id="cb209-5"><a href="readwrite.html#cb209-5" tabindex="-1"></a>lat <span class="ot">&lt;-</span> <span class="st">&quot;47.81&quot;</span>    </span>
<span id="cb209-6"><a href="readwrite.html#cb209-6" tabindex="-1"></a>lon <span class="ot">&lt;-</span> <span class="st">&quot;13.03&quot;</span></span>
<span id="cb209-7"><a href="readwrite.html#cb209-7" tabindex="-1"></a>apiKey <span class="ot">&lt;-</span> <span class="st">&quot;3f87141421b32590d50416aae5ca780c&quot;</span></span>
<span id="cb209-8"><a href="readwrite.html#cb209-8" tabindex="-1"></a></span>
<span id="cb209-9"><a href="readwrite.html#cb209-9" tabindex="-1"></a><span class="co"># Construct the full URL with query parameters using sprintf</span></span>
<span id="cb209-10"><a href="readwrite.html#cb209-10" tabindex="-1"></a>full_url <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s?lat=%s&amp;lon=%s&amp;appid=%s&quot;</span>, base, lat, lon, apiKey)</span>
<span id="cb209-11"><a href="readwrite.html#cb209-11" tabindex="-1"></a></span>
<span id="cb209-12"><a href="readwrite.html#cb209-12" tabindex="-1"></a><span class="co"># Display the constructed URL</span></span>
<span id="cb209-13"><a href="readwrite.html#cb209-13" tabindex="-1"></a><span class="fu">print</span>(full_url)</span></code></pre></div>
<pre><code>## [1] &quot;http://api.openweathermap.org/data/2.5/weather?lat=47.81&amp;lon=13.03&amp;appid=3f87141421b32590d50416aae5ca780c&quot;</code></pre>
<p>As a next step, the URL is passed to the <code>request()</code> function to create a request object, and <code>req_perform()</code> is used to execute the HTTP Get method:</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="readwrite.html#cb211-1" tabindex="-1"></a><span class="co"># Create the request and perform it</span></span>
<span id="cb211-2"><a href="readwrite.html#cb211-2" tabindex="-1"></a>req <span class="ot">&lt;-</span> httr2<span class="sc">::</span><span class="fu">request</span>(full_url)</span>
<span id="cb211-3"><a href="readwrite.html#cb211-3" tabindex="-1"></a>resp <span class="ot">&lt;-</span> httr2<span class="sc">::</span><span class="fu">req_perform</span>(req)</span></code></pre></div>
<p>By default, the <code>req_perform()</code> function returns a response object. Printing a response object provides useful information such as the actual URL used (after any redirects), the HTTP status, and the content type.</p>
<p>You can extract important parts of the response with various helper functions such as <code>resp_status()</code> and <code>resp_body_json()</code>:</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="readwrite.html#cb212-1" tabindex="-1"></a><span class="co"># Check the status code of the response</span></span>
<span id="cb212-2"><a href="readwrite.html#cb212-2" tabindex="-1"></a>httr2<span class="sc">::</span><span class="fu">resp_status</span>(resp)</span></code></pre></div>
<pre><code>## [1] 200</code></pre>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="readwrite.html#cb214-1" tabindex="-1"></a><span class="co"># View the content structure of the response in JSON</span></span>
<span id="cb214-2"><a href="readwrite.html#cb214-2" tabindex="-1"></a><span class="fu">str</span>(httr2<span class="sc">::</span><span class="fu">resp_body_json</span>(resp))</span></code></pre></div>
<pre><code>## List of 13
##  $ coord     :List of 2
##   ..$ lon: num 13
##   ..$ lat: num 47.8
##  $ weather   :List of 1
##   ..$ :List of 4
##   .. ..$ id         : int 802
##   .. ..$ main       : chr &quot;Clouds&quot;
##   .. ..$ description: chr &quot;scattered clouds&quot;
##   .. ..$ icon       : chr &quot;03d&quot;
##  $ base      : chr &quot;stations&quot;
##  $ main      :List of 8
##   ..$ temp      : num 301
##   ..$ feels_like: num 305
##   ..$ temp_min  : num 300
##   ..$ temp_max  : num 304
##   ..$ pressure  : int 1020
##   ..$ humidity  : int 81
##   ..$ sea_level : int 1020
##   ..$ grnd_level: int 947
##  $ visibility: int 10000
##  $ wind      :List of 2
##   ..$ speed: num 3.09
##   ..$ deg  : int 30
##  $ clouds    :List of 1
##   ..$ all: int 40
##  $ dt        : int 1721307964
##  $ sys       :List of 5
##   ..$ type   : int 1
##   ..$ id     : int 6877
##   ..$ country: chr &quot;AT&quot;
##   ..$ sunrise: int 1721273285
##   ..$ sunset : int 1721329186
##  $ timezone  : int 7200
##  $ id        : int 2766824
##  $ name      : chr &quot;Salzburg&quot;
##  $ cod       : int 200</code></pre>
<p>The Current Weather API call returned a number of real-time weather variables such as temperature, air pressure or humidity for the location of Salzburg. Current weather data may alternatively be retrieved by <code>City ID</code> or <code>City Name</code> (see the <a href="https://openweathermap.org/current" target="_blank">documentation</a> to get an overview of available API parameters).</p>

<div class="rmdexercise">
<p>Inspect the response object by means of a function called <code>headers()</code>. What methods are allowed when accessing the Current Weather API?</p>
<details closed>
<summary>
<ins>
<strong>See solution!</strong>
</ins>
</summary>
<p>
<p><i><font color="grey"></p>
<p>Only GET and POST methods are allowed.</p>
<p>Other APIs allow to update existing REST API resources (PUT method) or to delete a REST API resource (DELETE method).</p>
</font></i>
</p>
</details>
</div>
<p>To facilitate subsequent analyses and data visualization, we can convert the content of the return object to a data frame. With <code>httr2</code>, you can directly retrieve the JSON content and convert it to a data frame:</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="readwrite.html#cb216-1" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb216-2"><a href="readwrite.html#cb216-2" tabindex="-1"></a></span>
<span id="cb216-3"><a href="readwrite.html#cb216-3" tabindex="-1"></a><span class="co"># Using resp_body_json to get the JSON content of the response</span></span>
<span id="cb216-4"><a href="readwrite.html#cb216-4" tabindex="-1"></a>response_content <span class="ot">&lt;-</span> httr2<span class="sc">::</span><span class="fu">resp_body_json</span>(resp)</span>
<span id="cb216-5"><a href="readwrite.html#cb216-5" tabindex="-1"></a>response_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(response_content)</span>
<span id="cb216-6"><a href="readwrite.html#cb216-6" tabindex="-1"></a></span>
<span id="cb216-7"><a href="readwrite.html#cb216-7" tabindex="-1"></a><span class="co"># Select columns 1:5 of response data frame </span></span>
<span id="cb216-8"><a href="readwrite.html#cb216-8" tabindex="-1"></a><span class="co"># and render data frame as html table</span></span>
<span id="cb216-9"><a href="readwrite.html#cb216-9" tabindex="-1"></a>response_df <span class="sc">%&gt;%</span></span>
<span id="cb216-10"><a href="readwrite.html#cb216-10" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb216-11"><a href="readwrite.html#cb216-11" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(., <span class="at">format=</span><span class="st">&quot;html&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:right;">
coord.lon
</th>
<th style="text-align:right;">
coord.lat
</th>
<th style="text-align:right;">
weather.id
</th>
<th style="text-align:left;">
weather.main
</th>
<th style="text-align:left;">
weather.description
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
13.03
</td>
<td style="text-align:right;">
47.81
</td>
<td style="text-align:right;">
802
</td>
<td style="text-align:left;">
Clouds
</td>
<td style="text-align:left;">
scattered clouds
</td>
</tr>
</tbody>
</table>
<p>For purposes of presentation, the returned data frame was shortened to show only columns 1 to 5. The returned values contain a short description of current weather conditions at location <code>E: 13.03</code>, <code>N: 47.81</code>.</p>

<div class="rmdexercise">
Copy the code snippets above to a new R-Script and make an API request. <strong>Make sure to replace the key in the code example by your own API key!</strong> If you need help, please turn to the discussion forum.
</div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="datman.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="spm.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
