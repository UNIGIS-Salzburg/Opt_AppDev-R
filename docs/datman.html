<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Lesson 7 Data Manipulation | Automated Data Processing with R</title>
  <meta name="description" content="BookDown materials for the UNIGIS module Application Development - Introduction to R." />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="Lesson 7 Data Manipulation | Automated Data Processing with R" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/branding/Cover_epub.png" />
  <meta property="og:description" content="BookDown materials for the UNIGIS module Application Development - Introduction to R." />
  <meta name="github-repo" content="UNIGIS-Salzburg/En_AppDev-R" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Lesson 7 Data Manipulation | Automated Data Processing with R" />
  
  <meta name="twitter:description" content="BookDown materials for the UNIGIS module Application Development - Introduction to R." />
  <meta name="twitter:image" content="/branding/Cover_epub.png" />

<meta name="author" content="Christian Neuwirth &amp; Maximilian Elixhauser" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="branding/unigis_globe_gruen_transparent.png" type="image/x-icon" />
<link rel="prev" href="functions.html"/>
<link rel="next" href="readwrite.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.2.2/leaflet.js"></script>
<script src="libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.2.2/leaflet-providers-plugin.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="css/custom.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://unigis.at/en" target="_blank"><img alt="UNIGIS Salzburg" src="branding/UNIGIS_Salzburg_Schriftlogo_v05.png" width=100%></a></li>
<li><a href="./">Automated Data Processing with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction to R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#about-this-module"><i class="fa fa-check"></i><b>1.1</b> About this module</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#r-programming-language"><i class="fa fa-check"></i><b>1.2</b> R programming language</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#installation-and-setup"><i class="fa fa-check"></i><b>1.3</b> Installation and Setup</a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#interpreting-values"><i class="fa fa-check"></i><b>1.4</b> Interpreting Values</a></li>
<li class="chapter" data-level="1.5" data-path="intro.html"><a href="intro.html#simple-data-types"><i class="fa fa-check"></i><b>1.5</b> Simple Data Types</a></li>
<li class="chapter" data-level="1.6" data-path="intro.html"><a href="intro.html#numop"><i class="fa fa-check"></i><b>1.6</b> Numeric operators</a></li>
<li class="chapter" data-level="1.7" data-path="intro.html"><a href="intro.html#logical-operators"><i class="fa fa-check"></i><b>1.7</b> Logical operators</a></li>
<li class="chapter" data-level="1.8" data-path="intro.html"><a href="intro.html#references"><i class="fa fa-check"></i><b>1.8</b> References</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="core.html"><a href="core.html"><i class="fa fa-check"></i><b>2</b> Core Concepts</a>
<ul>
<li class="chapter" data-level="2.1" data-path="core.html"><a href="core.html#variables"><i class="fa fa-check"></i><b>2.1</b> Variables</a></li>
<li class="chapter" data-level="2.2" data-path="core.html"><a href="core.html#algorithms-and-functions"><i class="fa fa-check"></i><b>2.2</b> Algorithms and Functions</a></li>
<li class="chapter" data-level="2.3" data-path="core.html"><a href="core.html#libraries"><i class="fa fa-check"></i><b>2.3</b> Libraries</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="DS.html"><a href="DS.html"><i class="fa fa-check"></i><b>3</b> Data Structures</a>
<ul>
<li class="chapter" data-level="3.1" data-path="DS.html"><a href="DS.html#vectors"><i class="fa fa-check"></i><b>3.1</b> Vectors</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="DS.html"><a href="DS.html#vector-element-selection"><i class="fa fa-check"></i><b>3.1.1</b> Vector Element Selection</a></li>
<li class="chapter" data-level="3.1.2" data-path="DS.html"><a href="DS.html#using-the-range-function-with-vectors"><i class="fa fa-check"></i><b>3.1.2</b> Using the range() Function with Vectors</a></li>
<li class="chapter" data-level="3.1.3" data-path="DS.html"><a href="DS.html#applying-functions-to-vectors"><i class="fa fa-check"></i><b>3.1.3</b> Applying Functions to Vectors</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="DS.html"><a href="DS.html#multi-dimensional-data-types"><i class="fa fa-check"></i><b>3.2</b> Multi-dimensional Data Types</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="DS.html"><a href="DS.html#matrices"><i class="fa fa-check"></i><b>3.2.1</b> Matrices</a></li>
<li class="chapter" data-level="3.2.2" data-path="DS.html"><a href="DS.html#arrays"><i class="fa fa-check"></i><b>3.2.2</b> Arrays</a></li>
<li class="chapter" data-level="3.2.3" data-path="DS.html"><a href="DS.html#selection-in-multi-dimensional-data-types"><i class="fa fa-check"></i><b>3.2.3</b> Selection in Multi-Dimensional Data Types</a></li>
<li class="chapter" data-level="3.2.4" data-path="DS.html"><a href="DS.html#lists"><i class="fa fa-check"></i><b>3.2.4</b> Lists</a></li>
<li class="chapter" data-level="3.2.5" data-path="DS.html"><a href="DS.html#data-frame"><i class="fa fa-check"></i><b>3.2.5</b> Data Frame</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="spds.html"><a href="spds.html"><i class="fa fa-check"></i><b>4</b> Spatial Data Structures</a>
<ul>
<li class="chapter" data-level="4.1" data-path="spds.html"><a href="spds.html#vector-data-structures"><i class="fa fa-check"></i><b>4.1</b> Vector Data Structures</a></li>
<li class="chapter" data-level="4.2" data-path="spds.html"><a href="spds.html#raster-data-structures"><i class="fa fa-check"></i><b>4.2</b> Raster Data Structures</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="spds.html"><a href="spds.html#working-with-spatraster-objects"><i class="fa fa-check"></i><b>4.2.1</b> Working with SpatRaster objects</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="control-structures.html"><a href="control-structures.html"><i class="fa fa-check"></i><b>5</b> Control Structures</a>
<ul>
<li class="chapter" data-level="5.1" data-path="control-structures.html"><a href="control-structures.html#if"><i class="fa fa-check"></i><b>5.1</b> If</a></li>
<li class="chapter" data-level="5.2" data-path="control-structures.html"><a href="control-structures.html#else"><i class="fa fa-check"></i><b>5.2</b> Else</a></li>
<li class="chapter" data-level="5.3" data-path="control-structures.html"><a href="control-structures.html#code-blocks"><i class="fa fa-check"></i><b>5.3</b> Code blocks</a></li>
<li class="chapter" data-level="5.4" data-path="control-structures.html"><a href="control-structures.html#loops"><i class="fa fa-check"></i><b>5.4</b> Loops</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="control-structures.html"><a href="control-structures.html#while-and-repeat"><i class="fa fa-check"></i><b>5.4.1</b> While and repeat</a></li>
<li class="chapter" data-level="5.4.2" data-path="control-structures.html"><a href="control-structures.html#for"><i class="fa fa-check"></i><b>5.4.2</b> For</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="control-structures.html"><a href="control-structures.html#loops-with-conditional-statements"><i class="fa fa-check"></i><b>5.5</b> Loops with conditional statements</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="control-structures.html"><a href="control-structures.html#exercise-loops-with-conditional-statements"><i class="fa fa-check"></i><b>5.5.1</b> Exercise: loops with conditional statements</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>6</b> Functions</a>
<ul>
<li class="chapter" data-level="6.1" data-path="functions.html"><a href="functions.html#defining-functions"><i class="fa fa-check"></i><b>6.1</b> Defining Functions</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="functions.html"><a href="functions.html#understanding-the-return-function"><i class="fa fa-check"></i><b>6.1.1</b> Understanding the <code>return()</code> Function</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="functions.html"><a href="functions.html#more-parameters"><i class="fa fa-check"></i><b>6.2</b> More Parameters</a></li>
<li class="chapter" data-level="6.3" data-path="functions.html"><a href="functions.html#returning-multiple-values"><i class="fa fa-check"></i><b>6.3</b> Returning Multiple Values</a></li>
<li class="chapter" data-level="6.4" data-path="functions.html"><a href="functions.html#functions-and-control-structures"><i class="fa fa-check"></i><b>6.4</b> Functions and Control Structures</a></li>
<li class="chapter" data-level="6.5" data-path="functions.html"><a href="functions.html#scope"><i class="fa fa-check"></i><b>6.5</b> Scope</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="datman.html"><a href="datman.html"><i class="fa fa-check"></i><b>7</b> Data Manipulation</a>
<ul>
<li class="chapter" data-level="7.1" data-path="datman.html"><a href="datman.html#preparation"><i class="fa fa-check"></i><b>7.1</b> Preparation</a></li>
<li class="chapter" data-level="7.2" data-path="datman.html"><a href="datman.html#data-manipulation"><i class="fa fa-check"></i><b>7.2</b> Data manipulation</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="datman.html"><a href="datman.html#summarise"><i class="fa fa-check"></i><b>7.2.1</b> Summarise</a></li>
<li class="chapter" data-level="7.2.2" data-path="datman.html"><a href="datman.html#select-and-filter"><i class="fa fa-check"></i><b>7.2.2</b> Select and filter</a></li>
<li class="chapter" data-level="7.2.3" data-path="datman.html"><a href="datman.html#mutate"><i class="fa fa-check"></i><b>7.2.3</b> Mutate</a></li>
<li class="chapter" data-level="7.2.4" data-path="datman.html"><a href="datman.html#arrange"><i class="fa fa-check"></i><b>7.2.4</b> Arrange</a></li>
<li class="chapter" data-level="7.2.5" data-path="datman.html"><a href="datman.html#exercise-data-manipulation"><i class="fa fa-check"></i><b>7.2.5</b> Exercise: data manipulation</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="datman.html"><a href="datman.html#join"><i class="fa fa-check"></i><b>7.3</b> Join</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="datman.html"><a href="datman.html#exercise-join"><i class="fa fa-check"></i><b>7.3.1</b> Exercise: join</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="readwrite.html"><a href="readwrite.html"><i class="fa fa-check"></i><b>8</b> Read and Write Data</a>
<ul>
<li class="chapter" data-level="8.1" data-path="readwrite.html"><a href="readwrite.html#read-and-write-tabular-data"><i class="fa fa-check"></i><b>8.1</b> Read and write tabular data</a></li>
<li class="chapter" data-level="8.2" data-path="readwrite.html"><a href="readwrite.html#read-and-write-vector-data"><i class="fa fa-check"></i><b>8.2</b> Read and write vector data</a></li>
<li class="chapter" data-level="8.3" data-path="readwrite.html"><a href="readwrite.html#read-and-write-raster-data"><i class="fa fa-check"></i><b>8.3</b> Read and write raster data</a></li>
<li class="chapter" data-level="8.4" data-path="readwrite.html"><a href="readwrite.html#data-api"><i class="fa fa-check"></i><b>8.4</b> Data API</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="spm.html"><a href="spm.html"><i class="fa fa-check"></i><b>9</b> Spatial Data Manipulation</a>
<ul>
<li class="chapter" data-level="9.1" data-path="spm.html"><a href="spm.html#data-acquisition"><i class="fa fa-check"></i><b>9.1</b> Data Acquisition</a></li>
<li class="chapter" data-level="9.2" data-path="spm.html"><a href="spm.html#data-cleaning"><i class="fa fa-check"></i><b>9.2</b> Data Cleaning</a></li>
<li class="chapter" data-level="9.3" data-path="spm.html"><a href="spm.html#vector-operations"><i class="fa fa-check"></i><b>9.3</b> Vector operations</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="spm.html"><a href="spm.html#geometrical-operations"><i class="fa fa-check"></i><b>9.3.1</b> Geometrical operations</a></li>
<li class="chapter" data-level="9.3.2" data-path="spm.html"><a href="spm.html#binary-operations"><i class="fa fa-check"></i><b>9.3.2</b> Binary operations</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="spm.html"><a href="spm.html#raster-operations"><i class="fa fa-check"></i><b>9.4</b> Raster operations</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="spm.html"><a href="spm.html#resampling"><i class="fa fa-check"></i><b>9.4.1</b> Resampling</a></li>
<li class="chapter" data-level="9.4.2" data-path="spm.html"><a href="spm.html#crop-raster"><i class="fa fa-check"></i><b>9.4.2</b> Crop raster</a></li>
<li class="chapter" data-level="9.4.3" data-path="spm.html"><a href="spm.html#raster-algebra"><i class="fa fa-check"></i><b>9.4.3</b> Raster algebra</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="data-viz.html"><a href="data-viz.html"><i class="fa fa-check"></i><b>10</b> Data Visualization</a>
<ul>
<li class="chapter" data-level="10.1" data-path="data-viz.html"><a href="data-viz.html#the-grammar-of-graphics"><i class="fa fa-check"></i><b>10.1</b> The Grammar of Graphics</a></li>
<li class="chapter" data-level="10.2" data-path="data-viz.html"><a href="data-viz.html#understanding-wide-and-long-data-formats-in-r"><i class="fa fa-check"></i><b>10.2</b> Understanding Wide and Long Data Formats in R</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="data-viz.html"><a href="data-viz.html#wide-format"><i class="fa fa-check"></i><b>10.2.1</b> Wide format</a></li>
<li class="chapter" data-level="10.2.2" data-path="data-viz.html"><a href="data-viz.html#long-format"><i class="fa fa-check"></i><b>10.2.2</b> Long format:</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="data-viz.html"><a href="data-viz.html#visualization-of-distributions"><i class="fa fa-check"></i><b>10.3</b> Visualization of distributions</a></li>
<li class="chapter" data-level="10.4" data-path="data-viz.html"><a href="data-viz.html#boxplots"><i class="fa fa-check"></i><b>10.4</b> Boxplots</a></li>
<li class="chapter" data-level="10.5" data-path="data-viz.html"><a href="data-viz.html#scatterplots"><i class="fa fa-check"></i><b>10.5</b> Scatterplots</a></li>
<li class="chapter" data-level="10.6" data-path="data-viz.html"><a href="data-viz.html#map-visualization"><i class="fa fa-check"></i><b>10.6</b> Map Visualization</a></li>
<li class="chapter" data-level="10.7" data-path="data-viz.html"><a href="data-viz.html#interactive-maps"><i class="fa fa-check"></i><b>10.7</b> Interactive Maps</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="r-markdown.html"><a href="r-markdown.html"><i class="fa fa-check"></i><b>11</b> R Markdown</a>
<ul>
<li class="chapter" data-level="11.1" data-path="r-markdown.html"><a href="r-markdown.html#set-up-your-work-environment"><i class="fa fa-check"></i><b>11.1</b> Set up your work environment</a></li>
<li class="chapter" data-level="11.2" data-path="r-markdown.html"><a href="r-markdown.html#create-a-local-clone"><i class="fa fa-check"></i><b>11.2</b> Create a local clone</a></li>
<li class="chapter" data-level="11.3" data-path="r-markdown.html"><a href="r-markdown.html#creating-your-first-r-markdown-document"><i class="fa fa-check"></i><b>11.3</b> Creating Your First R Markdown Document</a></li>
<li class="chapter" data-level="11.4" data-path="r-markdown.html"><a href="r-markdown.html#synchronizing-with-github"><i class="fa fa-check"></i><b>11.4</b> Synchronizing with GitHub</a></li>
<li class="chapter" data-level="11.5" data-path="r-markdown.html"><a href="r-markdown.html#basic-r-markdown-syntax"><i class="fa fa-check"></i><b>11.5</b> Basic R Markdown Syntax</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="r-markdown.html"><a href="r-markdown.html#references-in-rmarkdown"><i class="fa fa-check"></i><b>11.5.1</b> References in RMarkdown</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="r-markdown.html"><a href="r-markdown.html#speed-up-your-workflows"><i class="fa fa-check"></i><b>11.6</b> Speed up your workflows</a></li>
<li class="chapter" data-level="11.7" data-path="r-markdown.html"><a href="r-markdown.html#self-study"><i class="fa fa-check"></i><b>11.7</b> Self-study</a></li>
</ul></li>
<li class="divider"></li>
<li>Copyright © UNIGIS Salzburg.</li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Automated Data Processing with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="datman" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">Lesson 7</span> Data Manipulation<a href="datman.html#datman" class="anchor-section" aria-label="Anchor link to header"></a></h1>

<div class="rmdtip">
<p>In most instances, the structure of the available data will not meet the specific requirements needed to perform the analyses you are interested in. Data analysts typically spend most of their time cleaning, filtering, restructuring data as well as harmonizing and joining data from different sources.</p>
<p>In this lesson, you will learn about the fundamental data wrangling operations using the <code>dplyr</code> library from the Tidyverse suite. You’ll also be introduced to <a href="https://tibble.tidyverse.org/" target="_blank">tibbles</a>, a modern take on data frames in R. Tibbles are lightweight and work seamlessly within the Tidyverse ecosystem. For more on tibbles, see <a href="https://r4ds.had.co.nz/tibbles.html" target="_blank">Tibbles in R for Data Science</a>.</p>
</div>
<div id="preparation" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> Preparation<a href="datman.html#preparation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>If not already installed on your machine, install both the <code>tidyverse</code> and <code>nycflights13</code> libraries. (see “libraries” in lesson <a href="core.html#core">2</a>).</p>
<p>The code below loads a sample dataset (a <a href="https://tibble.tidyverse.org/" target="_blank">tibble</a>) from the library <code>nycflights13</code> into the variable <code>flights_from_nyc</code>. We will use this sample data in this lesson.</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="datman.html#cb175-1" tabindex="-1"></a><span class="fu">library</span>(nycflights13)</span>
<span id="cb175-2"><a href="datman.html#cb175-2" tabindex="-1"></a>flights_from_nyc <span class="ot">&lt;-</span> nycflights13<span class="sc">::</span>flights</span></code></pre></div>
<p>The operator <code>::</code> is used to indicate that the function <code>flights</code> (that returns our sample dataset) is situated within the library <code>nycflights13</code>. This helps avoid ambiguities when functions from different loaded libraries have the same names.</p>
<p>In order to run the following data wrangling examples on your machine, add both lines above as well as the code snippets provided in the upcoming examples to a new R script file.</p>

<div class="rmdtip">
<p>Once you have loaded the flights table, open the <strong>Environment Tab</strong> in RStudio and double-click variable <code>flights_from_nyc</code> to inspect the variable contents.</p>
<p>Alternatively, you may inspect <code>flights_from_nyc</code> by writing it to the console.</p>
</div>
</div>
<div id="data-manipulation" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> Data manipulation<a href="datman.html#data-manipulation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The <code>dplyr</code> library provides a number of functions to investigate the basic characteristics of inputs. For instance, the function <code>count()</code> can be used to count the number of rows of a data frame or tibble. The code below uses <code>flights_from_nyc</code> as input to this function. The returned row count <code>n</code> is represented in a table.</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="datman.html#cb176-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb176-2"><a href="datman.html#cb176-2" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb176-3"><a href="datman.html#cb176-3" tabindex="-1"></a></span>
<span id="cb176-4"><a href="datman.html#cb176-4" tabindex="-1"></a>flights_from_nyc <span class="sc">%&gt;%</span></span>
<span id="cb176-5"><a href="datman.html#cb176-5" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">count</span>() <span class="sc">%&gt;%</span></span>
<span id="cb176-6"><a href="datman.html#cb176-6" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">336776</td>
</tr>
</tbody>
</table>
<p>In the example above, we use the pipe operator <code>%&gt;%</code>, a key feature of <code>magrittr</code> and <code>tidyverse</code> syntax. The operator links a sequence of analysis steps, passing <code>flights_from_nyc</code> through <code>count()</code> and then <code>kable()</code>. This makes the code simpler and more readable. For a deeper understanding, check out <a href="https://www.youtube.com/watch?v=sohARFx6aTo" target="_blank">this video</a>.</p>
<p>The same result could be achieved with a traditional approach using an intermediate variable or by nesting functions. However, these methods can make the code less readable compared to using the pipe operator:</p>
<p><strong>Intermediate Variable:</strong></p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="datman.html#cb177-1" tabindex="-1"></a>cnt <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">count</span>(flights_from_nyc)</span>
<span id="cb177-2"><a href="datman.html#cb177-2" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(cnt)</span></code></pre></div>
<p><strong>Nested Function:</strong></p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="datman.html#cb178-1" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(dplyr<span class="sc">::</span><span class="fu">count</span>(flights_from_nyc))</span></code></pre></div>
<p>The result is the same. However, nested structures are harder to read. Accordingly, the pipe operator is a powerful tool to simplify your code. See <a href="https://www.youtube.com/watch?v=sohARFx6aTo" target="_blank">this video</a> to learn more about it.</p>
<p>The function <code>count()</code> can also be used to count the number of rows of a table that has the same value for a given column, usually representing a category.</p>
<p>In the example below, the column name <code>origin</code> is provided as an argument to the function <code>count()</code>, so rows representing flights from the same origin are counted together – <code>EWR</code> is the Newark Liberty International Airport, <code>JFK</code> is the John F. Kennedy International Airport, and <code>LGA</code> is LaGuardia Airport.</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="datman.html#cb179-1" tabindex="-1"></a>flights_from_nyc <span class="sc">%&gt;%</span></span>
<span id="cb179-2"><a href="datman.html#cb179-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">count</span>(origin) <span class="sc">%&gt;%</span></span>
<span id="cb179-3"><a href="datman.html#cb179-3" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">origin</th>
<th align="right">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">EWR</td>
<td align="right">120835</td>
</tr>
<tr class="even">
<td align="left">JFK</td>
<td align="right">111279</td>
</tr>
<tr class="odd">
<td align="left">LGA</td>
<td align="right">104662</td>
</tr>
</tbody>
</table>
<p>Notice how the code becomes more readable with each operation on a new line after <code>%&gt;%</code>. Remember, the pipe operator passes the left-hand object as the first argument to the right-hand function. To change the argument placement, use <code>.</code> within the function call.</p>
<p>For example, you could explicitly pass variable <code>flights_from_nyc</code> as a first argument by <code>dplyr::count(., origin)</code>. Passing the variable as a second argument <code>dplyr::count(origin, .)</code> will return an error as the data frame is expected as a first input to function <code>count</code>.</p>
<div id="summarise" class="section level3 hasAnchor" number="7.2.1">
<h3><span class="header-section-number">7.2.1</span> Summarise<a href="datman.html#summarise" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To carry out more complex aggregations, the function <code>summarise()</code> can be used in combination with the function <code>group_by()</code> to summarise the values of the rows of a data frame or tibble. Rows having the same value for a selected column (in the example below, the same <code>origin</code>) are grouped together, then values are aggregated based on the defined function (using one or more columns in the calculation).</p>
<p>In the example below, the function <code>mean()</code> is applied to the column <code>distance</code> to calculate a new column <code>mean_distance_traveled_from</code> (the mean distance travelled by flights starting from each airport).</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="datman.html#cb180-1" tabindex="-1"></a>flights_from_nyc <span class="sc">%&gt;%</span></span>
<span id="cb180-2"><a href="datman.html#cb180-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(origin) <span class="sc">%&gt;%</span></span>
<span id="cb180-3"><a href="datman.html#cb180-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(</span>
<span id="cb180-4"><a href="datman.html#cb180-4" tabindex="-1"></a>    <span class="at">mean_distance_traveled_from =</span> <span class="fu">mean</span>(distance)</span>
<span id="cb180-5"><a href="datman.html#cb180-5" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb180-6"><a href="datman.html#cb180-6" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">origin</th>
<th align="right">mean_distance_traveled_from</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">EWR</td>
<td align="right">1056.7428</td>
</tr>
<tr class="even">
<td align="left">JFK</td>
<td align="right">1266.2491</td>
</tr>
<tr class="odd">
<td align="left">LGA</td>
<td align="right">779.8357</td>
</tr>
</tbody>
</table>
<p>The results show that the average distance covered by flights starting from <code>JFK</code> is significantly higher that flights departing from <code>LGA</code> or <code>EWR</code>.</p>
</div>
<div id="select-and-filter" class="section level3 hasAnchor" number="7.2.2">
<h3><span class="header-section-number">7.2.2</span> Select and filter<a href="datman.html#select-and-filter" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The function <code>select()</code> can be used to select a subset of <strong>columns</strong>. For instance in the code below, the function <code>select()</code> is used to select the columns <code>origin</code>, <code>dest</code>, and <code>dep_delay</code>. The function <code>slice_head</code> is used to include only the first <code>n</code> rows in the output.</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="datman.html#cb181-1" tabindex="-1"></a>flights_from_nyc <span class="sc">%&gt;%</span></span>
<span id="cb181-2"><a href="datman.html#cb181-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(origin, dest, dep_delay) <span class="sc">%&gt;%</span></span>
<span id="cb181-3"><a href="datman.html#cb181-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb181-4"><a href="datman.html#cb181-4" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">origin</th>
<th align="left">dest</th>
<th align="right">dep_delay</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">EWR</td>
<td align="left">IAH</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">LGA</td>
<td align="left">IAH</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="left">JFK</td>
<td align="left">MIA</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">JFK</td>
<td align="left">BQN</td>
<td align="right">-1</td>
</tr>
<tr class="odd">
<td align="left">LGA</td>
<td align="left">ATL</td>
<td align="right">-6</td>
</tr>
</tbody>
</table>
<p>The function <code>filter()</code> can instead be used to filter <strong>rows</strong> based on a specified condition. In the example below, the output of the <code>filter</code> step only includes the rows where the value of <code>month</code> is <code>11</code> (i.e., the eleventh month, November).</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="datman.html#cb182-1" tabindex="-1"></a>flights_from_nyc <span class="sc">%&gt;%</span></span>
<span id="cb182-2"><a href="datman.html#cb182-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(origin, dest, year, month, day, dep_delay) <span class="sc">%&gt;%</span></span>
<span id="cb182-3"><a href="datman.html#cb182-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(month <span class="sc">==</span> <span class="dv">11</span>) <span class="sc">%&gt;%</span></span>
<span id="cb182-4"><a href="datman.html#cb182-4" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb182-5"><a href="datman.html#cb182-5" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">origin</th>
<th align="left">dest</th>
<th align="right">year</th>
<th align="right">month</th>
<th align="right">day</th>
<th align="right">dep_delay</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">JFK</td>
<td align="left">PSE</td>
<td align="right">2013</td>
<td align="right">11</td>
<td align="right">1</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="left">JFK</td>
<td align="left">SYR</td>
<td align="right">2013</td>
<td align="right">11</td>
<td align="right">1</td>
<td align="right">105</td>
</tr>
<tr class="odd">
<td align="left">EWR</td>
<td align="left">CLT</td>
<td align="right">2013</td>
<td align="right">11</td>
<td align="right">1</td>
<td align="right">-5</td>
</tr>
<tr class="even">
<td align="left">LGA</td>
<td align="left">IAH</td>
<td align="right">2013</td>
<td align="right">11</td>
<td align="right">1</td>
<td align="right">-6</td>
</tr>
<tr class="odd">
<td align="left">JFK</td>
<td align="left">MIA</td>
<td align="right">2013</td>
<td align="right">11</td>
<td align="right">1</td>
<td align="right">-3</td>
</tr>
</tbody>
</table>
<p>Notice how <code>filter</code> is used in combination with <code>select</code>. All functions in the <code>dplyr</code> library can be combined, in any other order that makes logical sense. However, if the <code>select</code> step didn’t include <code>month</code>, that same column couldn’t have been used in the <code>filter</code> step.</p>
</div>
<div id="mutate" class="section level3 hasAnchor" number="7.2.3">
<h3><span class="header-section-number">7.2.3</span> Mutate<a href="datman.html#mutate" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The function <code>mutate()</code> can be used to add a new column to an output table. The <code>mutate</code> step in the code below adds a new column <code>air_time_hours</code> to the table obtained through the pipe, that is the flight air time in hours, dividing the flight air time in minutes by <code>60</code>.</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="datman.html#cb183-1" tabindex="-1"></a>flights_from_nyc <span class="sc">%&gt;%</span></span>
<span id="cb183-2"><a href="datman.html#cb183-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(flight, origin, dest, air_time) <span class="sc">%&gt;%</span></span>
<span id="cb183-3"><a href="datman.html#cb183-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb183-4"><a href="datman.html#cb183-4" tabindex="-1"></a>    <span class="at">air_time_hours =</span> air_time <span class="sc">/</span> <span class="dv">60</span></span>
<span id="cb183-5"><a href="datman.html#cb183-5" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb183-6"><a href="datman.html#cb183-6" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb183-7"><a href="datman.html#cb183-7" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">flight</th>
<th align="left">origin</th>
<th align="left">dest</th>
<th align="right">air_time</th>
<th align="right">air_time_hours</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1545</td>
<td align="left">EWR</td>
<td align="left">IAH</td>
<td align="right">227</td>
<td align="right">3.783333</td>
</tr>
<tr class="even">
<td align="right">1714</td>
<td align="left">LGA</td>
<td align="left">IAH</td>
<td align="right">227</td>
<td align="right">3.783333</td>
</tr>
<tr class="odd">
<td align="right">1141</td>
<td align="left">JFK</td>
<td align="left">MIA</td>
<td align="right">160</td>
<td align="right">2.666667</td>
</tr>
<tr class="even">
<td align="right">725</td>
<td align="left">JFK</td>
<td align="left">BQN</td>
<td align="right">183</td>
<td align="right">3.050000</td>
</tr>
<tr class="odd">
<td align="right">461</td>
<td align="left">LGA</td>
<td align="left">ATL</td>
<td align="right">116</td>
<td align="right">1.933333</td>
</tr>
</tbody>
</table>

<div class="rmdexercise">
<p>Run the mutate example above in a new script and replace <code>dplyr::mutate</code> with <code>dplyr::transmute</code>. What happens to your results?</p>
<details closed>
<summary>
<ins>
<strong>See solution!</strong>
</ins>
</summary>
<p>
<p><i><font color="grey"></p>
<p>The <code>transmute</code> function creates a new data frame containing only column <code>air_time_hours</code>. The function drops other table columns.</p>
</font></i>
</p>
</details>
</div>
</div>
<div id="arrange" class="section level3 hasAnchor" number="7.2.4">
<h3><span class="header-section-number">7.2.4</span> Arrange<a href="datman.html#arrange" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The function <code>arrange()</code> sorts a `tibble or data frame in ascending order based on the values in the specified column. If a negative sign is specified before the column name, the descending order is used. The code below would produce a table showing all the rows when ordered by descending order of air time.</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="datman.html#cb184-1" tabindex="-1"></a>flights_from_nyc <span class="sc">%&gt;%</span></span>
<span id="cb184-2"><a href="datman.html#cb184-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(origin, dest, air_time) <span class="sc">%&gt;%</span></span>
<span id="cb184-3"><a href="datman.html#cb184-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="sc">-</span>air_time) <span class="sc">%&gt;%</span></span>
<span id="cb184-4"><a href="datman.html#cb184-4" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb184-5"><a href="datman.html#cb184-5" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">origin</th>
<th align="left">dest</th>
<th align="right">air_time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">EWR</td>
<td align="left">HNL</td>
<td align="right">695</td>
</tr>
<tr class="even">
<td align="left">JFK</td>
<td align="left">HNL</td>
<td align="right">691</td>
</tr>
<tr class="odd">
<td align="left">JFK</td>
<td align="left">HNL</td>
<td align="right">686</td>
</tr>
<tr class="even">
<td align="left">JFK</td>
<td align="left">HNL</td>
<td align="right">686</td>
</tr>
<tr class="odd">
<td align="left">JFK</td>
<td align="left">HNL</td>
<td align="right">683</td>
</tr>
</tbody>
</table>
<p>In the examples above, we have used <code>slice_head</code> to present only the first <code>n</code> rows in a table, based on the existing order.</p>
</div>
<div id="exercise-data-manipulation" class="section level3 hasAnchor" number="7.2.5">
<h3><span class="header-section-number">7.2.5</span> Exercise: data manipulation<a href="datman.html#exercise-data-manipulation" class="anchor-section" aria-label="Anchor link to header"></a></h3>

<div class="rmdexercise">
<p>The Food and Agriculture Organization (FAO) is a specialized agency of the United Nations that leads international efforts to defeat hunger. On their <a href="http://www.fao.org/home/en/" target="_blank">Website</a> they provide comprehensive datasets on global crop and livestock production. Your task in this exercise is to create a table that shows national African sorghum production in 2019.</p>
</div>
<ol style="list-style-type: decimal">
<li>Create an RScript and install or load the libraries <code>tidyverse</code> and <code>knitr</code>, if not done yet.</li>
<li>Bulk download <a href="http://www.fao.org/faostat/en/#data/QCL" target="_blank">African Crop and Livestock Production</a> data as CSV:</li>
</ol>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:L06-faodata"></span>
<img src="images/FAODataAfrica.png" alt="FAO Data Download" width="100%" />
<p class="caption">
Figure 7.1: FAO Data Download
</p>
</div>
<ol start="3" style="list-style-type: decimal">
<li>Read data from comma-separated CSV (<code>"Production_Crops_Livestock_E_Africa_NOFLAG.csv"</code>) into your Script.</li>
</ol>
<pre echo="FALSE"><code>fao_data &lt;- read.csv(directory as string, header = TRUE, sep = &quot;,&quot;)</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>Use the pipe operator to perform the following operations:
<ol style="list-style-type: lower-alpha">
<li>Select columns <code>Area</code>, <code>Item</code>, <code>Element</code>, <code>Unit</code> and <code>Y2019</code></li>
<li>Filter rows that contain sorghum production (<code>Item == "Sorghum" &amp; Element == "Production"</code>)</li>
<li>Sort the table based on yield in descending order (<code>arrange</code>)</li>
<li>remove rows including <code>No Data</code> by means of function <code>drop_na()</code></li>
<li>render the table using the function <code>kable()</code> of <code>library knitr</code></li>
</ol></li>
</ol>
<p>See <a href="Solution_Exercise_DataWrangling1.R" target="_blank">my solution</a>!</p>
<p><strong>Note on Encoding:</strong> When working with datasets from various sources, you may encounter encoding errors. If such an issue arises, a simple approach is to specify the encoding in the <code>read.csv()</code> function. For instance, you can use <code>read.csv(..., fileEncoding = "latin1")</code>. However, the best case would be, to check the original encoding of the data beforehand and match it in your <code>read.csv()</code> command. Encoding can be tricky, and while it’s outside the scope of this exercise, being aware of it is crucial in data analysis.</p>
</div>
</div>
<div id="join" class="section level2 hasAnchor" number="7.3">
<h2><span class="header-section-number">7.3</span> Join<a href="datman.html#join" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A join operation combines two tables into one by matching rows that have the same values in a specified column. This operation is usually executed on columns containing identifiers, which are matched through different tables containing different data about the same real-world entities.</p>
<p>For instance, the table created below (data frame <code>city_telephone_prexix</code>) contains the telephone prefixes of three cities.</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="datman.html#cb186-1" tabindex="-1"></a>city_telephone_prexix <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb186-2"><a href="datman.html#cb186-2" tabindex="-1"></a>    <span class="at">city =</span> <span class="fu">c</span>(<span class="st">&quot;Leicester&quot;</span>, <span class="st">&quot;Birmingham&quot;</span>, <span class="st">&quot;London&quot;</span>),</span>
<span id="cb186-3"><a href="datman.html#cb186-3" tabindex="-1"></a>    <span class="at">telephon_prefix =</span> <span class="fu">c</span>(<span class="st">&quot;0116&quot;</span>, <span class="st">&quot;0121&quot;</span>, <span class="st">&quot;0171&quot;</span>)</span>
<span id="cb186-4"><a href="datman.html#cb186-4" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb186-5"><a href="datman.html#cb186-5" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">as_tibble</span>()</span>
<span id="cb186-6"><a href="datman.html#cb186-6" tabindex="-1"></a></span>
<span id="cb186-7"><a href="datman.html#cb186-7" tabindex="-1"></a>city_telephone_prexix <span class="sc">%&gt;%</span></span>
<span id="cb186-8"><a href="datman.html#cb186-8" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">city</th>
<th align="left">telephon_prefix</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Leicester</td>
<td align="left">0116</td>
</tr>
<tr class="even">
<td align="left">Birmingham</td>
<td align="left">0121</td>
</tr>
<tr class="odd">
<td align="left">London</td>
<td align="left">0171</td>
</tr>
</tbody>
</table>
<p>That information can be combined with the data present in a second table <code>city_info_wide</code> (see below) through the join operation on the columns containing the city names.</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="datman.html#cb187-1" tabindex="-1"></a>city_info_wide <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb187-2"><a href="datman.html#cb187-2" tabindex="-1"></a>    <span class="at">city =</span> <span class="fu">c</span>(<span class="st">&quot;Leicester&quot;</span>, <span class="st">&quot;Nottingham&quot;</span>),</span>
<span id="cb187-3"><a href="datman.html#cb187-3" tabindex="-1"></a>    <span class="at">population =</span> <span class="fu">c</span>(<span class="dv">329839</span>, <span class="dv">321500</span>),</span>
<span id="cb187-4"><a href="datman.html#cb187-4" tabindex="-1"></a>    <span class="at">area =</span> <span class="fu">c</span>(<span class="fl">73.3</span>, <span class="fl">74.6</span>),</span>
<span id="cb187-5"><a href="datman.html#cb187-5" tabindex="-1"></a>    <span class="at">density =</span> <span class="fu">c</span>(<span class="dv">4500</span>, <span class="dv">4412</span>)</span>
<span id="cb187-6"><a href="datman.html#cb187-6" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb187-7"><a href="datman.html#cb187-7" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">as_tibble</span>()</span>
<span id="cb187-8"><a href="datman.html#cb187-8" tabindex="-1"></a></span>
<span id="cb187-9"><a href="datman.html#cb187-9" tabindex="-1"></a>city_info_wide <span class="sc">%&gt;%</span></span>
<span id="cb187-10"><a href="datman.html#cb187-10" tabindex="-1"></a> knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">city</th>
<th align="right">population</th>
<th align="right">area</th>
<th align="right">density</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Leicester</td>
<td align="right">329839</td>
<td align="right">73.3</td>
<td align="right">4500</td>
</tr>
<tr class="even">
<td align="left">Nottingham</td>
<td align="right">321500</td>
<td align="right">74.6</td>
<td align="right">4412</td>
</tr>
</tbody>
</table>

<div class="rmdtip">
Note that data frames in the code above are converted to <a href="https://tibble.tidyverse.org/" target="_blank">tibbles</a>. This step is necessary because the <code>kable()</code> function requires <code>tibbles</code> as input.
</div>
<p>Joins between two tables can be executed by different join operations. The <code>dplyr</code> library offers join operations, which correspond to <code>SQL</code> joins illustrated in the image below.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:L06-joins"></span>
<img src="images/joins.png" alt="Join types" width="70%" />
<p class="caption">
Figure 7.2: Join types
</p>
</div>
<p>Please take your time to understand the examples below that show different realizations of joins between table <code>city_telephone_prexix</code> and table <code>city_info_wide</code>.</p>
<p>The first four examples execute the exact same <em>full join</em> operation using three different syntaxes: with or without using the pipe operator and specifying the <code>by</code> argument or not. Note that all those approaches to writing the join are valid and produce the same result. The choice about which approach to use will depend on the code you are writing. In particular, you might find it useful to use the syntax that uses the pipe operator when the join operation is itself only one stem in a series of data manipulation steps. Using the <code>by</code> argument is usually advisable unless you are certain that you aim to join two tables with all and exactly the column that have the same names in the two table.</p>
<p>Note how the result of the join operations is <em>not</em> saved to a variable. The function <code>knitr::kable</code> is added after each join operation through a pipe <code>%&gt;%</code> to display the resulting table in a nice format.</p>
<div style="page-break-after: always;"></div>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="datman.html#cb188-1" tabindex="-1"></a><span class="co"># Option 1: without using the pipe operator</span></span>
<span id="cb188-2"><a href="datman.html#cb188-2" tabindex="-1"></a><span class="co"># full join verb</span></span>
<span id="cb188-3"><a href="datman.html#cb188-3" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">full_join</span>(</span>
<span id="cb188-4"><a href="datman.html#cb188-4" tabindex="-1"></a>    <span class="co"># left table</span></span>
<span id="cb188-5"><a href="datman.html#cb188-5" tabindex="-1"></a>    city_info_wide,</span>
<span id="cb188-6"><a href="datman.html#cb188-6" tabindex="-1"></a>    <span class="co"># right table</span></span>
<span id="cb188-7"><a href="datman.html#cb188-7" tabindex="-1"></a>    city_telephone_prexix,</span>
<span id="cb188-8"><a href="datman.html#cb188-8" tabindex="-1"></a>    <span class="co"># columns to match</span></span>
<span id="cb188-9"><a href="datman.html#cb188-9" tabindex="-1"></a>    <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;city&quot;</span> <span class="ot">=</span> <span class="st">&quot;city&quot;</span>)</span>
<span id="cb188-10"><a href="datman.html#cb188-10" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb188-11"><a href="datman.html#cb188-11" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">city</th>
<th align="right">population</th>
<th align="right">area</th>
<th align="right">density</th>
<th align="left">telephon_prefix</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Leicester</td>
<td align="right">329839</td>
<td align="right">73.3</td>
<td align="right">4500</td>
<td align="left">0116</td>
</tr>
<tr class="even">
<td align="left">Nottingham</td>
<td align="right">321500</td>
<td align="right">74.6</td>
<td align="right">4412</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">Birmingham</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">0121</td>
</tr>
<tr class="even">
<td align="left">London</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">0171</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="datman.html#cb189-1" tabindex="-1"></a><span class="co"># Option 2: without using the pipe operator</span></span>
<span id="cb189-2"><a href="datman.html#cb189-2" tabindex="-1"></a><span class="co">#   and without using the argument &quot;by&quot;</span></span>
<span id="cb189-3"><a href="datman.html#cb189-3" tabindex="-1"></a><span class="co">#   as columns have the same name</span></span>
<span id="cb189-4"><a href="datman.html#cb189-4" tabindex="-1"></a><span class="co">#   in the two tables.</span></span>
<span id="cb189-5"><a href="datman.html#cb189-5" tabindex="-1"></a><span class="co"># Same result as Option 1</span></span>
<span id="cb189-6"><a href="datman.html#cb189-6" tabindex="-1"></a><span class="co"># full join verb</span></span>
<span id="cb189-7"><a href="datman.html#cb189-7" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">full_join</span>(</span>
<span id="cb189-8"><a href="datman.html#cb189-8" tabindex="-1"></a>    <span class="co"># left table</span></span>
<span id="cb189-9"><a href="datman.html#cb189-9" tabindex="-1"></a>    city_info_wide,</span>
<span id="cb189-10"><a href="datman.html#cb189-10" tabindex="-1"></a>    <span class="co"># right table</span></span>
<span id="cb189-11"><a href="datman.html#cb189-11" tabindex="-1"></a>    city_telephone_prexix</span>
<span id="cb189-12"><a href="datman.html#cb189-12" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb189-13"><a href="datman.html#cb189-13" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">city</th>
<th align="right">population</th>
<th align="right">area</th>
<th align="right">density</th>
<th align="left">telephon_prefix</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Leicester</td>
<td align="right">329839</td>
<td align="right">73.3</td>
<td align="right">4500</td>
<td align="left">0116</td>
</tr>
<tr class="even">
<td align="left">Nottingham</td>
<td align="right">321500</td>
<td align="right">74.6</td>
<td align="right">4412</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">Birmingham</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">0121</td>
</tr>
<tr class="even">
<td align="left">London</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">0171</td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="datman.html#cb190-1" tabindex="-1"></a><span class="co"># Option 3: using the pipe operator</span></span>
<span id="cb190-2"><a href="datman.html#cb190-2" tabindex="-1"></a><span class="co">#   and without using the argument &quot;by&quot;</span></span>
<span id="cb190-3"><a href="datman.html#cb190-3" tabindex="-1"></a><span class="co">#   as columns have the same name</span></span>
<span id="cb190-4"><a href="datman.html#cb190-4" tabindex="-1"></a><span class="co">#   in the two tables.</span></span>
<span id="cb190-5"><a href="datman.html#cb190-5" tabindex="-1"></a><span class="co"># Same result as Option 1 and 2</span></span>
<span id="cb190-6"><a href="datman.html#cb190-6" tabindex="-1"></a><span class="co"># left table</span></span>
<span id="cb190-7"><a href="datman.html#cb190-7" tabindex="-1"></a>city_info_wide <span class="sc">%&gt;%</span></span>
<span id="cb190-8"><a href="datman.html#cb190-8" tabindex="-1"></a>  <span class="co"># full join verb</span></span>
<span id="cb190-9"><a href="datman.html#cb190-9" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">full_join</span>(</span>
<span id="cb190-10"><a href="datman.html#cb190-10" tabindex="-1"></a>    <span class="co"># right table</span></span>
<span id="cb190-11"><a href="datman.html#cb190-11" tabindex="-1"></a>    city_telephone_prexix</span>
<span id="cb190-12"><a href="datman.html#cb190-12" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb190-13"><a href="datman.html#cb190-13" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">city</th>
<th align="right">population</th>
<th align="right">area</th>
<th align="right">density</th>
<th align="left">telephon_prefix</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Leicester</td>
<td align="right">329839</td>
<td align="right">73.3</td>
<td align="right">4500</td>
<td align="left">0116</td>
</tr>
<tr class="even">
<td align="left">Nottingham</td>
<td align="right">321500</td>
<td align="right">74.6</td>
<td align="right">4412</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">Birmingham</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">0121</td>
</tr>
<tr class="even">
<td align="left">London</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">0171</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="datman.html#cb191-1" tabindex="-1"></a><span class="co"># Option 4: using the pipe operator</span></span>
<span id="cb191-2"><a href="datman.html#cb191-2" tabindex="-1"></a><span class="co">#   and using the argument &quot;by&quot;.</span></span>
<span id="cb191-3"><a href="datman.html#cb191-3" tabindex="-1"></a><span class="co"># Same result as Option 1, 2 and 3</span></span>
<span id="cb191-4"><a href="datman.html#cb191-4" tabindex="-1"></a><span class="co"># left table</span></span>
<span id="cb191-5"><a href="datman.html#cb191-5" tabindex="-1"></a>city_info_wide <span class="sc">%&gt;%</span></span>
<span id="cb191-6"><a href="datman.html#cb191-6" tabindex="-1"></a>  <span class="co"># full join verb</span></span>
<span id="cb191-7"><a href="datman.html#cb191-7" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">full_join</span>(</span>
<span id="cb191-8"><a href="datman.html#cb191-8" tabindex="-1"></a>    <span class="co"># right table</span></span>
<span id="cb191-9"><a href="datman.html#cb191-9" tabindex="-1"></a>    city_telephone_prexix,</span>
<span id="cb191-10"><a href="datman.html#cb191-10" tabindex="-1"></a>    <span class="co"># columns to match</span></span>
<span id="cb191-11"><a href="datman.html#cb191-11" tabindex="-1"></a>    <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;city&quot;</span> <span class="ot">=</span> <span class="st">&quot;city&quot;</span>)</span>
<span id="cb191-12"><a href="datman.html#cb191-12" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb191-13"><a href="datman.html#cb191-13" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">city</th>
<th align="right">population</th>
<th align="right">area</th>
<th align="right">density</th>
<th align="left">telephon_prefix</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Leicester</td>
<td align="right">329839</td>
<td align="right">73.3</td>
<td align="right">4500</td>
<td align="left">0116</td>
</tr>
<tr class="even">
<td align="left">Nottingham</td>
<td align="right">321500</td>
<td align="right">74.6</td>
<td align="right">4412</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">Birmingham</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">0121</td>
</tr>
<tr class="even">
<td align="left">London</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">0171</td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="datman.html#cb192-1" tabindex="-1"></a><span class="co"># Left join</span></span>
<span id="cb192-2"><a href="datman.html#cb192-2" tabindex="-1"></a><span class="co"># Using syntax similar to Option 1 above</span></span>
<span id="cb192-3"><a href="datman.html#cb192-3" tabindex="-1"></a><span class="co"># left join</span></span>
<span id="cb192-4"><a href="datman.html#cb192-4" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">left_join</span>(</span>
<span id="cb192-5"><a href="datman.html#cb192-5" tabindex="-1"></a>    <span class="co"># left table</span></span>
<span id="cb192-6"><a href="datman.html#cb192-6" tabindex="-1"></a>    city_info_wide, </span>
<span id="cb192-7"><a href="datman.html#cb192-7" tabindex="-1"></a>    <span class="co"># right table</span></span>
<span id="cb192-8"><a href="datman.html#cb192-8" tabindex="-1"></a>    city_telephone_prexix,</span>
<span id="cb192-9"><a href="datman.html#cb192-9" tabindex="-1"></a>    <span class="co"># columns to match</span></span>
<span id="cb192-10"><a href="datman.html#cb192-10" tabindex="-1"></a>    <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;city&quot;</span> <span class="ot">=</span> <span class="st">&quot;city&quot;</span>)</span>
<span id="cb192-11"><a href="datman.html#cb192-11" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb192-12"><a href="datman.html#cb192-12" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">city</th>
<th align="right">population</th>
<th align="right">area</th>
<th align="right">density</th>
<th align="left">telephon_prefix</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Leicester</td>
<td align="right">329839</td>
<td align="right">73.3</td>
<td align="right">4500</td>
<td align="left">0116</td>
</tr>
<tr class="even">
<td align="left">Nottingham</td>
<td align="right">321500</td>
<td align="right">74.6</td>
<td align="right">4412</td>
<td align="left">NA</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="datman.html#cb193-1" tabindex="-1"></a><span class="co"># Right join</span></span>
<span id="cb193-2"><a href="datman.html#cb193-2" tabindex="-1"></a><span class="co"># Using syntax similar to Option 2 above</span></span>
<span id="cb193-3"><a href="datman.html#cb193-3" tabindex="-1"></a><span class="co"># right join verb</span></span>
<span id="cb193-4"><a href="datman.html#cb193-4" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">right_join</span>(</span>
<span id="cb193-5"><a href="datman.html#cb193-5" tabindex="-1"></a>    <span class="co"># left table</span></span>
<span id="cb193-6"><a href="datman.html#cb193-6" tabindex="-1"></a>    city_info_wide, </span>
<span id="cb193-7"><a href="datman.html#cb193-7" tabindex="-1"></a>    <span class="co"># right table</span></span>
<span id="cb193-8"><a href="datman.html#cb193-8" tabindex="-1"></a>    city_telephone_prexix</span>
<span id="cb193-9"><a href="datman.html#cb193-9" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb193-10"><a href="datman.html#cb193-10" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">city</th>
<th align="right">population</th>
<th align="right">area</th>
<th align="right">density</th>
<th align="left">telephon_prefix</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Leicester</td>
<td align="right">329839</td>
<td align="right">73.3</td>
<td align="right">4500</td>
<td align="left">0116</td>
</tr>
<tr class="even">
<td align="left">Birmingham</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">0121</td>
</tr>
<tr class="odd">
<td align="left">London</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">0171</td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="datman.html#cb194-1" tabindex="-1"></a><span class="co"># Inner join</span></span>
<span id="cb194-2"><a href="datman.html#cb194-2" tabindex="-1"></a><span class="co"># Using syntax similar to Option 3 above</span></span>
<span id="cb194-3"><a href="datman.html#cb194-3" tabindex="-1"></a><span class="co"># left table</span></span>
<span id="cb194-4"><a href="datman.html#cb194-4" tabindex="-1"></a>city_info_wide <span class="sc">%&gt;%</span></span>
<span id="cb194-5"><a href="datman.html#cb194-5" tabindex="-1"></a>  <span class="co"># inner join</span></span>
<span id="cb194-6"><a href="datman.html#cb194-6" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">inner_join</span>(</span>
<span id="cb194-7"><a href="datman.html#cb194-7" tabindex="-1"></a>    <span class="co"># right table</span></span>
<span id="cb194-8"><a href="datman.html#cb194-8" tabindex="-1"></a>    city_telephone_prexix</span>
<span id="cb194-9"><a href="datman.html#cb194-9" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb194-10"><a href="datman.html#cb194-10" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">city</th>
<th align="right">population</th>
<th align="right">area</th>
<th align="right">density</th>
<th align="left">telephon_prefix</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Leicester</td>
<td align="right">329839</td>
<td align="right">73.3</td>
<td align="right">4500</td>
<td align="left">0116</td>
</tr>
</tbody>
</table>
<p>Compare the results of respective full, left, right and inner join operations. Turn to the discussion forum in case you need further explanations.</p>
<div id="exercise-join" class="section level3 hasAnchor" number="7.3.1">
<h3><span class="header-section-number">7.3.1</span> Exercise: join<a href="datman.html#exercise-join" class="anchor-section" aria-label="Anchor link to header"></a></h3>

<div class="rmdexercise">
<p>In the previous exercise, we created a table that shows national African sorghum production in 2019. In this exercise we will join crop production statistics with a table that contains national boundaries and visualize sorghum production quantities in a simple map.</p>
</div>
<ol style="list-style-type: decimal">
<li><p>Create an RScript and install and load the libraries <code>tidyverse</code>, <code>knitr</code>, <code>ggplot2</code> and <code>maps</code>, if not done yet.</p></li>
<li><p>Copy the <a href="Solution_Exercise_DataWrangling1.R" target="_blank">code from the previous exercise</a> into your new RScript. Note that the result of the pipe operations is <em>not</em> saved to a variable. Save it to a variable.</p></li>
<li><p>Use the <code>ggplot2</code> function <a href="https://ggplot2.tidyverse.org/reference/map_data.html" target="_blank"><code>map_data</code></a> to convert the built in sample dataset <code>world</code> (comes with library <a href="https://cran.r-project.org/web/packages/maps/index.html" target="_blank"><code>maps</code></a>) to a data frame:</p></li>
</ol>
<pre echo="FALSE"><code>world_ctry &lt;- map_data(&quot;world&quot;) </code></pre>
<ol start="4" style="list-style-type: decimal">
<li><p>Inspect the structure of this data frame. Every row represents a node (defined by long/lat) of a polygon feature (national boundaries).</p></li>
<li><p>Join tables (left table: geographic features, right table: sorghum production statistics) based on country names. Make sure to choose a join method (<code>full_join</code>, <code>inner_join</code>, <code>left_join</code> or <code>right_join</code>) that allows for retaining all the geographic features.</p></li>
</ol>
<p><a href="Solution_Exercise_DataWrangling2.R" target="_blank">Our exercise solution</a> creates a simple output map. Don’t worry in <a href="data-viz.html#data-viz">Lesson 10</a> we will cover visualization methods in more detail.</p>

<div class="rmdtip">
<p>Take a look at the <a href="https://www.rstudio.com/resources/cheatsheets/" target="_blank">dplyr Cheatsheet</a> which shows the most important dplyr operations at a glance.</p>
</div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="functions.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="readwrite.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
